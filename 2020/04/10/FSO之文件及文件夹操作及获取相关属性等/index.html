<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>FSO之文件及文件夹操作及获取相关属性等 | 钞票搬运工</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="FSO之文件及文件夹操作及获取相关属性等本文摘自excelhome论坛liulang0808的文章，主要是太经典了，怕将来不开源了，记录下来，以备常常学习和借用。 总体的代码框架如下： 123456Sub 按钮1_Click()   Application.ScreenUpdating &#x3D; False    Set fso &#x3D;CreateObject(&quot;Scripting.FileSystemOb">
<meta property="og:type" content="article">
<meta property="og:title" content="FSO之文件及文件夹操作及获取相关属性等">
<meta property="og:url" content="https://hnzyc.github.io,http//y2s6pn.coding-pages.com/2020/04/10/FSO%E4%B9%8B%E6%96%87%E4%BB%B6%E5%8F%8A%E6%96%87%E4%BB%B6%E5%A4%B9%E6%93%8D%E4%BD%9C%E5%8F%8A%E8%8E%B7%E5%8F%96%E7%9B%B8%E5%85%B3%E5%B1%9E%E6%80%A7%E7%AD%89/index.html">
<meta property="og:site_name" content="钞票搬运工">
<meta property="og:description" content="FSO之文件及文件夹操作及获取相关属性等本文摘自excelhome论坛liulang0808的文章，主要是太经典了，怕将来不开源了，记录下来，以备常常学习和借用。 总体的代码框架如下： 123456Sub 按钮1_Click()   Application.ScreenUpdating &#x3D; False    Set fso &#x3D;CreateObject(&quot;Scripting.FileSystemOb">
<meta property="article:published_time" content="2020-04-10T13:21:49.787Z">
<meta property="article:modified_time" content="2020-03-20T13:37:27.389Z">
<meta property="article:author" content="Davy Zhao">
<meta property="article:tag" content="投资">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="钞票搬运工" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">钞票搬运工</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">投资、成长，终生学习</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://hnzyc.github.io,http://y2s6pn.coding-pages.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-FSO之文件及文件夹操作及获取相关属性等" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/04/10/FSO%E4%B9%8B%E6%96%87%E4%BB%B6%E5%8F%8A%E6%96%87%E4%BB%B6%E5%A4%B9%E6%93%8D%E4%BD%9C%E5%8F%8A%E8%8E%B7%E5%8F%96%E7%9B%B8%E5%85%B3%E5%B1%9E%E6%80%A7%E7%AD%89/" class="article-date">
  <time datetime="2020-04-10T13:21:49.787Z" itemprop="datePublished">2020-04-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      FSO之文件及文件夹操作及获取相关属性等
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="FSO之文件及文件夹操作及获取相关属性等"><a href="#FSO之文件及文件夹操作及获取相关属性等" class="headerlink" title="FSO之文件及文件夹操作及获取相关属性等"></a><strong>FSO之文件及文件夹操作及获取相关属性等</strong></h1><p>本文摘自excelhome论坛liulang0808的<a href="http://club.excelhome.net/forum.php?mod=viewthread&tid=1174170&extra=&authorid=238368&page=1" target="_blank" rel="noopener">文章</a>，主要是太经典了，怕将来不开源了，记录下来，以备常常学习和借用。</p>
<p>总体的代码框架如下：</p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> 按钮<span class="number">1</span>_Click()</span><br><span class="line">   Application.ScreenUpdating = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">Set</span> fso =<span class="built_in">CreateObject</span>(<span class="string">"Scripting.FileSystemObject"</span>)</span><br><span class="line"><span class="comment">'    此处根据具体操作添加代码</span></span><br><span class="line">   Application.ScreenUpdating = <span class="literal">True</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="一、文件有关的操作"><a href="#一、文件有关的操作" class="headerlink" title="一、文件有关的操作"></a>一、文件有关的操作</h2><ol>
<li>判断文件是否存在</li>
</ol>
<p>FileExists方法用于判断指定的文件是否存在，若存在则返回True。其语法为：<br>fso.FileExists(Filepath)<br>Filepath为文件完整路径，String类型，不能包含有通配符。如果用户有充分的权限，Filepath可以是网络路径或共享名<br>示例如下：</p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> 按钮<span class="number">1</span>_Click()</span><br><span class="line">    Application.ScreenUpdating = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">Set</span> fso = <span class="built_in">CreateObject</span>(<span class="string">"Scripting.FileSystemObject"</span>)</span><br><span class="line">    strfile = Application.<span class="built_in">InputBox</span>(<span class="string">"请输入文件的完整名称:"</span>, <span class="string">"请输入文件的完整名称:"</span>, , , , , , <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">If</span> fso.fileexists(strfile) <span class="keyword">Then</span></span><br><span class="line">        <span class="built_in">MsgBox</span> strfile &amp; <span class="string">" :存在"</span></span><br><span class="line">    <span class="keyword">Else</span></span><br><span class="line">        <span class="built_in">MsgBox</span> strfile &amp; <span class="string">" :不存在"</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">    Application.ScreenUpdating = <span class="literal">True</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>移动文件</li>
</ol>
<p>MoveFile方法用来移动文件，将文件从一个文件夹移动到另一个文件夹。其语法为：<br>FSO.MoveFile source,destination<br>参数source必需，指定要移动的文件的路径，String类型。参数destination必需，指定文件移动操作中的目标位置的路径，String类型。<br>如果Source包含通配符或者destination以路径分隔符结尾，则认为destination是一个路径，否则认为destination的最后一部分是文件名。<br>如果目标文件已经存在，则将出现一个错误。<br>source可以包含通配符，但只能出现在它的最后一部分中。<br>destination参数不能包含通配符。<br>source或destination可以是相对路径或绝对路径，可以是网络路径或共享名。<br>MoveFile方法在开始操作前先解析source和destination这两个参数。<br>实例如下：</p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> 按钮<span class="number">1</span>_Click()</span><br><span class="line">    Application.ScreenUpdating = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">Set</span> fso = <span class="built_in">CreateObject</span>(<span class="string">"Scripting.FileSystemObject"</span>)</span><br><span class="line">    sourcefile = ThisWorkbook.Path &amp; <span class="string">"\txt\*"</span> <span class="comment">'将txt文件下所有文件移走，首先需要确认是相关文件时针的存在</span></span><br><span class="line"></span><br><span class="line">    destinationfolder = ThisWorkbook.Path &amp; <span class="string">"\tt\"</span> <span class="comment">'注意路径格式“tt\”，后面的“\”</span></span><br><span class="line"></span><br><span class="line">    fso.movefile sourcefile, destinationfolder</span><br><span class="line">    Application.ScreenUpdating = <span class="literal">True</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>拷贝文件</li>
</ol>
<p>CopyFile方法用来复制文件，将文件从一个文件夹复制到另一个文件夹。其语法为：<br>fso.CopyFile Source,Destination [,OverwriteFiles]<br>参数Source必需，指定要复制的文件的路径和名称，String类型。参数Destination必需，代表复制文件的目标路径和文件名（可选），String类型。参数OverwriteFiles可选，表示是否覆盖一个现有文件的标志，True表示覆盖，False表示不覆盖，Boolean类型，默认值为True。<br>参数source中源路径可以是绝对路径或相对路径，源文件名可包含通配符但源路径不能。在参数Destination中不能包含通配符。<br>如果目标路径或文件设置为只读，则无论OverwriteFiles参数的值如何，都将无法完成CopyFile方法。如果参数OverwriteFiles设置为False且Destination指定的文件已经存在，则会产生一个运行时错误“文件已经存在”。如果在复制多个文件时出现错误，CopyFile方法将立即停止复制操作，该方法不具有撤销错误前文件复制操作的返回功能。如果用户有充分的权限，那么source或destination可以是网络路径或共享名。 CopyFile方法可以复制一个保存在特定文件夹中的文件。如果文件夹本身有包含文件的子文件夹，则使用CopyFile方法不能复制这些文件，应该使用CopyFolder方法。<br>具体实例如下：</p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> 按钮<span class="number">1</span>_Click()</span><br><span class="line">    Application.ScreenUpdating = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">Set</span> fso = <span class="built_in">CreateObject</span>(<span class="string">"Scripting.FileSystemObject"</span>)</span><br><span class="line">    sourcefile = ThisWorkbook.Path &amp; <span class="string">"\txt\*"</span> <span class="comment">'将txt文件下所有文件拷贝走，首先需要确认是相关文件时针的存在</span></span><br><span class="line">    destinationfolder = ThisWorkbook.Path &amp; <span class="string">"\tt\"</span> <span class="comment">'注意此处不同于movefile，后面的“\”可以省略，只要确实存在该文件夹</span></span><br><span class="line">    fso.copyfile sourcefile, destinationfolder</span><br><span class="line">    Application.ScreenUpdating = <span class="literal">True</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<ol start="4">
<li>删除文件</li>
</ol>
<p>DeleteFile方法删除指定的一个或多个文件。其语法为：<br>fso.DeleteFile FileSpec[,Force]<br>参数FileSpec必需，代表要删除的单个文件或多个文件的名称和路径，String类型，可以在路径的最后部分包含通配符，可以为相对路径或绝对路径。如果在FileSpec中只有文件名，则认为该文件在应用程序的当前驱动器和文件夹中。参数Force可选，如果将其设置为True，则忽略文件的只读标志并删除该文件，Boolean类型，默认值为False。<br>如果指定要删除的文件已经打开，该方法将失败并出现一个“Permission Denied”错误。如果找不到指定的文件，则该方法失败。<br>如果在删除多个文件的过程中出现错误，DeleteFile方法将立即停止删除操作，即不能删除余下的文件部分。该方法不具有撤销产生错误前文件删除操作的返回功能。<br>如果用户有充分的权限，源路径或目标路径可以是网络路径或共享名。<br>注意：DeleteFile方法永久性地删除文件，并不把这些文件移到回收站中。<br>示例如下：</p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> 按钮<span class="number">1</span>_Click()</span><br><span class="line">    Application.ScreenUpdating = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">Set</span> fso = <span class="built_in">CreateObject</span>(<span class="string">"Scripting.FileSystemObject"</span>)</span><br><span class="line">    strfile = Application.<span class="built_in">InputBox</span>(<span class="string">"请输入文件的完整名称:"</span>, <span class="string">"请输入文件的完整名称:"</span>, , , , , , <span class="number">2</span>)</span><br><span class="line">    fso.deletefile strfile</span><br><span class="line">    Application.ScreenUpdating = <span class="literal">True</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<ol start="5">
<li>GetFile方法</li>
</ol>
<p>GetFile方法用来返回一个File对象。<br>其语法为：fso.GetFile (FilePath)<br>参数FilePath必需，指定路径和文件名，String类型。可以是绝对路径或相对路径。如果FilePath是一个共享名或网络路径，GetFile确认该驱动器或共享是File对象创建进程的一部分。如果参数FilePath指定的路径的任何部分不能连接或不存在，就会产生错误。<br>GetFile方法返回的是File对象，而不是TextStream对象。File对象不是打开的文件，主要是用来完成如复制或移动文件和询问文件的属性之类的方法。尽管不能对File对象进行写或读操作，但可以使用File对象的OpenAsTextStream方法获得TextStream对象。<br>要获得所需的FilePath字符串，首先应该使用GetAbsolutePathName方法。如果FilePath包含网络驱动器或共享，可以在调用GetFile方法之前用DriveExists方法来检验所需的驱动器是否可用。<br>因为在FilePath指定的文件不存在时会产生错误，所以应该在调用GetFile之前调用FileExists方法确定文件是否存在。<br>必须用Set语句将File对象赋给一个局部对象变量。<br><strong>具体实例见下面的属性代码</strong></p>
<ol start="6">
<li>文件的各种属性</li>
</ol>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> 按钮<span class="number">1</span>_Click()</span><br><span class="line">    Application.ScreenUpdating = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">Set</span> fso = <span class="built_in">CreateObject</span>(<span class="string">"Scripting.FileSystemObject"</span>)</span><br><span class="line">    strfile = Application.<span class="built_in">InputBox</span>(<span class="string">"请输入文件的完整名称:"</span>, <span class="string">"请输入文件的完整名称:"</span>, , , , , , <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">Set</span> objfile = fso.GetFile(strfile)</span><br><span class="line">    <span class="keyword">If</span> fso.fileexists(strfile) <span class="keyword">Then</span></span><br><span class="line">      </span><br><span class="line">        sReturn = <span class="string">"文件属性： "</span> &amp; objfile.Attributes &amp; vbCrLf</span><br><span class="line">         </span><br><span class="line">        sReturn = sReturn &amp; <span class="string">"文件创建日期： "</span> &amp; objfile.DateCreated &amp; vbCrLf</span><br><span class="line">         </span><br><span class="line">        sReturn = sReturn &amp; <span class="string">"文件修改日期： "</span> &amp; objfile.DateLastModified &amp; vbCrLf</span><br><span class="line">         </span><br><span class="line">        sReturn = sReturn &amp; <span class="string">"文件大小 "</span> &amp; <span class="built_in">FormatNumber</span>(objfile.Size / <span class="number">1024</span>, <span class="number">-1</span>)</span><br><span class="line">         </span><br><span class="line">        sReturn = sReturn &amp; <span class="string">"Kb"</span> &amp; vbCrLf</span><br><span class="line">         </span><br><span class="line">        sReturn = sReturn &amp; <span class="string">"文件类型： "</span> &amp; objfile.Type &amp; vbCrLf</span><br><span class="line"></span><br><span class="line">        <span class="built_in">MsgBox</span> sReturn</span><br><span class="line"></span><br><span class="line">    <span class="keyword">Else</span></span><br><span class="line">        <span class="built_in">MsgBox</span> strfile &amp; <span class="string">" :不存在"</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">    Application.ScreenUpdating = <span class="literal">True</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="二、文件夹操作"><a href="#二、文件夹操作" class="headerlink" title="二、文件夹操作"></a>二、文件夹操作</h2><ol>
<li>判断文件夹是否存在</li>
</ol>
<p>FolderExists方法可以判断指定的文件夹是否存在，若存在则返回True。其语法为：<br>fso.FolderExists(FolderSpec)<br>参数FolderSpec指定文件夹的完整路径，String类型，不能包含通配符。<br>如果用户有充分的权限，FolderSpec可以是网络路径或共享名，例如：<br>If fso.FileExists (“\NTSERV1\d$\TestPath&quot;) Then</p>
<p>示例如下：</p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> 按钮<span class="number">1</span>_Click()</span><br><span class="line">    Application.ScreenUpdating = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">Set</span> fso = <span class="built_in">CreateObject</span>(<span class="string">"Scripting.FileSystemObject"</span>)</span><br><span class="line">    strfile = Application.<span class="built_in">InputBox</span>(<span class="string">"请输入文件的完整名称:"</span>, <span class="string">"请输入文件的完整名称:"</span>, , , , , , <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">If</span> fso.fileexists(strfile) <span class="keyword">Then</span></span><br><span class="line">        <span class="built_in">MsgBox</span> strfile &amp; <span class="string">" :存在"</span></span><br><span class="line">    <span class="keyword">Else</span></span><br><span class="line">        <span class="built_in">MsgBox</span> strfile &amp; <span class="string">" :不存在"</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">    Application.ScreenUpdating = <span class="literal">True</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>移动</li>
</ol>
<p>MoveFolder方法用来移动文件夹，将文件夹及其文件和子文件夹一起从某个位置移动到另一个位置。其语法为：<br>fso.MoveFolder source,destination<br>参数Source指定要移动的文件夹的路径，String类型。参数destination指定文件夹移动操作中目标位置的路径，String类型。<br>Source必须以通配符或非路径分隔符结束，可以使用通配符，但必须出现在最后一部分中。destination不能使用通配符。除非不允许使用通配符，否则源文件夹中所有的子文件夹和文件都被复制到destination指定的位置，也就是说MoveFolder方法是递归的。<br>如果destination用路径分隔符结束或者source用通配符结束，MoveFolder就认为source中指定的文件夹存在于destination中。例如，假设有如下文件夹结构：<br>MoveFolder “C:\Rootone*“,”C:\RootTow&quot;<br>产生如下文件夹结构：<br>MoveFolder “C:\Rootone”,”C:\RootTwo&quot;<br>产生如下文件夹结构：<br>Source和destination可以为绝对路径或相对路径，可以为网络路径或共享名。<br>MoveFile方法在开始操作前先解析source和destination这两个参数。</p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> 按钮<span class="number">1</span>_Click()</span><br><span class="line">    Application.ScreenUpdating = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">Set</span> fso = <span class="built_in">CreateObject</span>(<span class="string">"Scripting.FileSystemObject"</span>)</span><br><span class="line">    sfolder = ThisWorkbook.Path &amp; <span class="string">"\tt"</span></span><br><span class="line">    dfolder = ThisWorkbook.Path &amp; <span class="string">"\txt\"</span></span><br><span class="line">    <span class="keyword">If</span> <span class="keyword">Not</span> fso.folderexists(sfolder) <span class="keyword">Then</span></span><br><span class="line">        <span class="built_in">MsgBox</span> sfolder &amp; <span class="string">" :不存在"</span></span><br><span class="line">        <span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">   </span><br><span class="line">    <span class="keyword">If</span> <span class="keyword">Not</span> fso.folderexists(dfolder) <span class="keyword">Then</span></span><br><span class="line">        <span class="built_in">MsgBox</span> dfolder &amp; <span class="string">" :不存在"</span></span><br><span class="line">        <span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">    fso.movefolder sfolder, dfolder</span><br><span class="line">    Application.ScreenUpdating = <span class="literal">True</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>拷贝</li>
</ol>
<p>CopyFolder方法用于复制文件夹，即将一个文件夹的内容（包括其子文件夹）复制到其他位置。其语法为：<br>fso.CopyFolder Source,Destination[,OverwriteFiles]<br>参数Source必需，指定要复制的文件夹的路径和文件夹名，String类型，必须使用通配符或者非路径分隔符来结束。参数Destination必需，指定文件夹复制操作的目标文件夹的路径，String类型。参数OverwriteFiles可选，表示是否被覆盖一个现有文件的标志，True表示覆盖，False表示不覆盖，Boolean类型。<br>通配符只能在参数Source中使用，但是只能放在最后的组件中。在参数Destination中不能使用通配符。<br>除非不允许使用通配符，否则就可以把源文件夹中的所有子文件夹和文件都复制到Destination指定的文件夹中，也就是说CopyFolder方法是递归的。<br>如果参数Destination以一个路径分隔符结束或者参数Source以一个通配符结束，CopyFolder方法就认为参数Source中的指定的文件夹存在于参数Destination中，否则就创建这样一个文件夹。例如，假设有如下的文件夹结构：<br>CopyFolder “C:\Rootone*“,”C:\RootTwo”<br>产生如下的文件夹结构：<br>CopyFolder “C:\Rootone”,”C:\RootTwo&quot;<br>产生如下的文件夹结构：<br>如果参数Destination指定的目标路径或任意文件被设置成只读属性，则不论OverwriteFiles的值如何，CopyFolder方法者将失效。<br>如果OverwriterFiles设置为False，而参数Source指定的源文件夹或任何文件存在于参数Destination中，将产生运行时错误“文件已经存在”。<br>如果在复制多个文件夹时出现错误，CopyFolder方法立即停止复制操作，不再复制余下要复制的文件。该方法不具有撤销产生错误前文件复制操作的返回功能。<br>如果用户有充分的权限，source或destination都可以是网络路径或共享名，例如：<br>CopyFolder “C:\Rootone”,”\NTSERV1\d$\RootTwo&quot;</p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> 按钮<span class="number">1</span>_Click()</span><br><span class="line">    Application.ScreenUpdating = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">Set</span> fso = <span class="built_in">CreateObject</span>(<span class="string">"Scripting.FileSystemObject"</span>)</span><br><span class="line">    sfolder = ThisWorkbook.Path &amp; <span class="string">"\tt"</span></span><br><span class="line">    dfolder = ThisWorkbook.Path &amp; <span class="string">"\txt\"</span></span><br><span class="line">    <span class="keyword">If</span> <span class="keyword">Not</span> fso.folderexists(sfolder) <span class="keyword">Then</span></span><br><span class="line">        <span class="built_in">MsgBox</span> sfolder &amp; <span class="string">" :不存在"</span></span><br><span class="line">        <span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">   </span><br><span class="line">    <span class="keyword">If</span> <span class="keyword">Not</span> fso.folderexists(dfolder) <span class="keyword">Then</span></span><br><span class="line">        <span class="built_in">MsgBox</span> dfolder &amp; <span class="string">" :不存在"</span></span><br><span class="line">        <span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">    fso.copyfolder sfolder, dfolder</span><br><span class="line">    Application.ScreenUpdating = <span class="literal">True</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<ol start="4">
<li>删除文件夹</li>
</ol>
<p>DeleteFolder方法用于删除指定的文件夹及其所有的文件和子文件夹。其语法为：<br>fso.DeleteFolder FileSpec[,Force]<br>参数FileSpec必需，指定要删除的文件夹的名称和路径，String类型。在参数FileSpec中，可以在路径的最后部分包含通配符，但不能用路径分隔符结束，可以为相对路径或绝对路径。<br>参数Force可选，Boolean类型，如果设置为True，将忽略文件的只读标志并删除这个文件。默认为False。如果参数Force设置为False并且文件夹中的任意一个文件为只读，则该方法将失败。如果找不到指定的文件夹，则该方法失败。<br>如果指定的文件夹中有文件已经打开，则不能完成删除操作，且产生一个“Permisson Denied”错误。DeleteFolder方法删除指定文件夹中的所有内容，包括其他文件夹及其内容。<br>如果在删除多个文件或文件夹时出现错误，DeleteFolder方法将立即停止删除操作，即不能删除余下的文件夹或文件。该方法不具有撤销产生错误前文件夹删除操作的返回功能。<br>DeleteFolder方法永久性删除文件夹，并不把它们移到回收站中。<br>如果用户有充分的权限，源路径和目标路径可以是网络路径或共享名，例如：<br>DeleteFolder “\RootTest”</p>
<p>示例如下：</p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> 按钮<span class="number">1</span>_Click()</span><br><span class="line">    Application.ScreenUpdating = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">Set</span> fso = <span class="built_in">CreateObject</span>(<span class="string">"Scripting.FileSystemObject"</span>)</span><br><span class="line">    sfolder = ThisWorkbook.Path &amp; <span class="string">"\txt\tt"</span></span><br><span class="line">    <span class="keyword">If</span> <span class="keyword">Not</span> fso.folderexists(sfolder) <span class="keyword">Then</span></span><br><span class="line">        <span class="built_in">MsgBox</span> sfolder &amp; <span class="string">" :不存在"</span></span><br><span class="line">        <span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">   </span><br><span class="line">    fso.deletefolder sfolder</span><br><span class="line">    Application.ScreenUpdating = <span class="literal">True</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<ol start="5">
<li>创建文件夹</li>
</ol>
<p>CreateFolder方法用于在指定的路径下创建一个新文件夹，并返回其Folder对象。其语法为：<br>fso.CreateFolder (Path)<br>参数Path必需，为一个返回要创建的新文件夹名的表达式，String类型。Path指定的路径可以是相对路径也可以是绝对路径，如果没有指定路径则使用当前驱动器和目录作为路径。在新的文件夹名中不能使用通配符。<br>如果参数Path指定的路径为只读，则CreateFolder方法将失败；如果参数Path指定的文件夹已经存在，就会产生运行时错误“文件已经存在”。如果用户有充分的权限，则参数Path可以指定为网络路径或共享名，例如：<br>Fso.CreateFolder “\NTSERV1\RootTest\newFolder”<br>示例如下：</p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> 按钮<span class="number">1</span>_Click()</span><br><span class="line">    Application.ScreenUpdating = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">Set</span> fso = <span class="built_in">CreateObject</span>(<span class="string">"Scripting.FileSystemObject"</span>)</span><br><span class="line">    sfolder = ThisWorkbook.Path &amp; <span class="string">"\thisfolder"</span></span><br><span class="line">    <span class="keyword">If</span> fso.folderexists(sfolder) <span class="keyword">Then</span></span><br><span class="line">        <span class="built_in">MsgBox</span> sfolder &amp; <span class="string">" :已经存在"</span></span><br><span class="line">        <span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">   </span><br><span class="line">    fso.CreateFolder sfolder</span><br><span class="line">    Application.ScreenUpdating = <span class="literal">True</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<ol start="6">
<li>GetAbsolutePathName方法</li>
</ol>
<p>将相对路径转变为一个全限定路径（包括驱动器名），返回一个字符串，包含一个给定的路径说明的绝对路径。其语法为：<br>fso.GetAbsolutePathName (Path)<br>参数Path必需，代表路径说明，String类型。<br>“.”返回当前文件夹的驱动器名和完整路径。“..”返回当前文件夹的父文件夹的驱动器名和路径。“filename”返回当前文件夹中的文件的驱动器名、路径及文件名。<br>所有相对路径名均以当前文件夹为基准。<br>如果没有明确地提供驱动器作为Path的一部分，就以当前驱动器作为Path参数中的驱动器。在Path中可以包含任意个通配符。<br>对于映射网络驱动器和共享而言，这种方法不能返回完整的网络地址，而是返回全限定的本地路径和本地驱动器名。<br>GetAbsolutePathName不能检验指定路径中是否存在某个给定的文件或文件夹</p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> 按钮<span class="number">1</span>_Click()</span><br><span class="line">    Application.ScreenUpdating = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">Set</span> fso = <span class="built_in">CreateObject</span>(<span class="string">"Scripting.FileSystemObject"</span>)</span><br><span class="line">    sfolder = <span class="string">"thisfolder"</span></span><br><span class="line">    <span class="keyword">If</span> fso.folderexists(sfolder) <span class="keyword">Then</span></span><br><span class="line">        <span class="built_in">MsgBox</span> sfolder &amp; <span class="string">" :已经存在"</span></span><br><span class="line">        <span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">   </span><br><span class="line">    str1 = fso.GetAbsolutePathName(sfolder)</span><br><span class="line">    <span class="built_in">MsgBox</span> sfolder &amp; <span class="string">"  ：的绝对路径为： "</span> &amp; str1</span><br><span class="line">    Application.ScreenUpdating = <span class="literal">True</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<ol start="8">
<li>GetParentFolderName方法</li>
</ol>
<p>返回给定路径中最后部分前的文件夹名，其语法为：<br>fso.GetParentFolderName (Path)<br>参数Path必需，指定路径说明，String类型。<br>如果从Path中不能确定父文件夹名，就返回一个零长字符串（””）。Path可以为相对路径或绝对路径。可以是网络驱动器或共享。<br>GetParentFolderName方法不能检验Path的某个部分是否存在。<br>GetParentFolderName方法认为Path中不属于驱动器说明的那部分字符串除了最后一部分外余下的字符串就是父文件夹。除此之外它不做任何其他检测，更像是一个字符串解析和处理例程而不是与对象处理有关的例程。</p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> 按钮<span class="number">1</span>_Click()</span><br><span class="line">    Application.ScreenUpdating = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">Set</span> fso = <span class="built_in">CreateObject</span>(<span class="string">"Scripting.FileSystemObject"</span>)</span><br><span class="line">    sfolder = ThisWorkbook.Path &amp; <span class="string">"\tt\"</span></span><br><span class="line">    <span class="keyword">If</span> <span class="keyword">Not</span> fso.folderexists(sfolder) <span class="keyword">Then</span></span><br><span class="line">        <span class="built_in">MsgBox</span> sfolder &amp; <span class="string">" :不存在"</span></span><br><span class="line">        <span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">   </span><br><span class="line">    str1 = fso.GetParentFolderName(sfolder)</span><br><span class="line">    <span class="built_in">MsgBox</span> sfolder &amp; <span class="string">"  ：父路径： "</span> &amp; str1</span><br><span class="line">    Application.ScreenUpdating = <span class="literal">True</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<ol start="9">
<li>GetSpecialFolder方法</li>
</ol>
<p>GetSpecialFolder方法返回操作系统文件夹路径，其中0代表Windows文件夹，1代表System（系统）文件夹，2代表Temp（临时）文件夹。其语法为：<br>fso.GetSpecialFolder (SpecialFolder)<br>参数SpecialFolder必需，为特殊的文件夹常数，表示三种特殊系统文件夹中其中一个的值。<br>可以使用Set语句将Folder对象赋给一个局部对象变量，但是如果只对检索特殊的文件夹感兴趣，就可以使用下列语句来实现：<br>sPath=fso.GetSpecialFolder (iFolderConst)<br>或：<br>sPath=fso.GetSpecialFolder (iFolderConst).Path<br>由于Path属性是Folder对象的缺省属性，所认第一个语句有效。因为不是给一个对象变量赋值，所以赋给sPath的值是缺省的Path属性值，而不是对象引用。<br>示例</p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> 按钮<span class="number">1</span>_Click()</span><br><span class="line">    Application.ScreenUpdating = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">Dim</span> strWindowsFolder As <span class="built_in">String</span></span><br><span class="line">    <span class="keyword">Dim</span> strSystemFolder As <span class="built_in">String</span></span><br><span class="line">    <span class="keyword">Dim</span> strTempFolder As <span class="built_in">String</span></span><br><span class="line">    <span class="keyword">Set</span> fso = <span class="built_in">CreateObject</span>(<span class="string">"Scripting.FileSystemObject"</span>)</span><br><span class="line">    strWindowsFolder = fso.GetSpecialFolder(<span class="number">0</span>)</span><br><span class="line">    strSystemFolder = fso.GetSpecialFolder(<span class="number">1</span>)</span><br><span class="line">    strTempFolder = fso.GetSpecialFolder(<span class="number">2</span>)</span><br><span class="line">    <span class="built_in">MsgBox</span> strWindowsFolder &amp; vbCrLf &amp; strSystemFolder &amp; vbCrLf _</span><br><span class="line">    &amp; strTempFolder, vbInformation + vbOKOnly, <span class="string">"Special Folders"</span></span><br><span class="line">    Application.ScreenUpdating = <span class="literal">True</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<ol start="10">
<li>GetFolder方法</li>
</ol>
<p>GetFolder方法返回Folder对象。其语法为：<br>fso.GetFolder (FolderPath)<br>参数FolderPath必需，指定所需文件夹的路径，String类型，可以为相对路径或绝对路径。如果FolderPath是共享名或网络路径，GetFolder确认该驱动器或共享是File对象创建进程的一部分。如果FolderPath的任何部分不能连接或不存在，就会产生一个错误。<br>要获得所需的Path字符串，首先应该使用GetAbsolutePathName方法。如果FolderPath包含一个网络驱动器或共享，可以在调用GetFolder方法之前使用DriveExists方法确认指定的驱动器是否可用。由于GetFolder方法要求FolderPath是一个有效文件夹的路径，所以应调用FolderExists方法来检验FolderPath是否存在。<br>必须使用Set语句将Folder对象赋给一个局部对象变量。<br>具体实例见楼下 属性获取</p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> 按钮<span class="number">1</span>_Click()</span><br><span class="line">    Application.ScreenUpdating = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">Dim</span> sReturn As <span class="built_in">String</span></span><br><span class="line">    <span class="keyword">Set</span> fso = <span class="built_in">CreateObject</span>(<span class="string">"Scripting.FileSystemObject"</span>)</span><br><span class="line">    <span class="keyword">Set</span> folder1 = fso.GetFolder(ThisWorkbook.Path &amp; <span class="string">"\"</span>)</span><br><span class="line">    sReturn = <span class="string">"文件夹属性： "</span> &amp; folder1.Attributes &amp; vbCrLf</span><br><span class="line">    <span class="comment">'获取最近一次访问的时间</span></span><br><span class="line">    sReturn = sReturn &amp; <span class="string">"创建时间： "</span> &amp; folder1.Datecreated &amp; vbCrLf</span><br><span class="line">    sReturn = sReturn &amp; <span class="string">"最后访问时间： is "</span> &amp; folder1.DateLastAccessed &amp; vbCrLf</span><br><span class="line">    <span class="comment">'获取最后一次修改的时间</span></span><br><span class="line">    sReturn = sReturn &amp; <span class="string">"最后修改时间： "</span> &amp; folder1.DateLastModified &amp; vbCrLf</span><br><span class="line">    <span class="comment">'获取文件夹的大小</span></span><br><span class="line">    sReturn = sReturn &amp; <span class="string">"文件夹大小： "</span> &amp; <span class="built_in">FormatNumber</span>(folder1.Size / <span class="number">1024</span>, <span class="number">0</span>)</span><br><span class="line">    sReturn = sReturn &amp; <span class="string">"Kb"</span> &amp; vbCrLf</span><br><span class="line">    <span class="comment">'判断文件或文件夹类型</span></span><br><span class="line">    sReturn = sReturn &amp; <span class="string">"类型为： "</span> &amp; folder1.Type &amp; vbCrLf</span><br><span class="line">    <span class="built_in">MsgBox</span> sReturn</span><br><span class="line">    Application.ScreenUpdating = <span class="literal">True</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="三、另一牛人的代码-跟我学-【喜迎2015立春】遍历文件夹-含子文件夹-方法-ABC"><a href="#三、另一牛人的代码-跟我学-【喜迎2015立春】遍历文件夹-含子文件夹-方法-ABC" class="headerlink" title="三、另一牛人的代码- 跟我学 【喜迎2015立春】遍历文件夹(含子文件夹)方法 ABC"></a>三、另一牛人的代码- <strong>跟我学 【喜迎2015立春】遍历文件夹(含子文件夹)方法 ABC</strong></h2><p>以下内容摘自另一牛人香川群子的<a href="http://club.excelhome.net/thread-1185089-1-1.html" target="_blank" rel="noopener">文章</a>，其中FSO操作代码简洁，带有弹出框选择目标位置，也摘录下来：</p>
<p>首先要介绍，在VBA代码运行以后，调用【目标文件夹】的方法：</p>
<p>① 微软Excel VBA 默认选择文件夹的Dialog对话框</p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> ListFilesTest()</span><br><span class="line">    <span class="keyword">With</span> Application.FileDialog(msoFileDialogFolderPicker) <span class="comment">'运行后出现标准的选择文件夹对话框        </span></span><br><span class="line">        <span class="keyword">If</span> .Show <span class="keyword">Then</span> myPath = .SelectedItems(<span class="number">1</span>) <span class="keyword">Else</span> <span class="keyword">Exit</span> <span class="keyword">Sub</span> <span class="comment">'如选中则返回=-1 / 取消未选则返回=0 </span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">    <span class="keyword">If</span> <span class="built_in">Right</span>(myPath, <span class="number">1</span>) &lt;&gt; <span class="string">""</span> <span class="keyword">Then</span> myPath = myPath &amp; <span class="string">""</span> </span><br><span class="line">    <span class="comment">'返回的是选中目标文件夹的绝对路径,但除了本地C盘、D盘会以"C:"形式返回外，其余路径无""需要自己添加 </span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<p>② 视窗浏览器界面选择目标文件夹</p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> ListFilesTest()</span><br><span class="line">    <span class="keyword">Set</span> myFolder = <span class="built_in">CreateObject</span>(<span class="string">"Shell.Application"</span>).BrowseForFolder(<span class="number">0</span>, <span class="string">"GetFolder"</span>, <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">If</span> <span class="keyword">Not</span> myFolder <span class="keyword">Is</span> <span class="literal">Nothing</span> <span class="keyword">Then</span> myPath$ = myFolder.Items.Item.Path <span class="keyword">Else</span> <span class="built_in">MsgBox</span> <span class="string">"Folder not Selected"</span>: <span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line">    <span class="keyword">If</span> <span class="built_in">Right</span>(myPath, <span class="number">1</span>) &lt;&gt; <span class="string">""</span> <span class="keyword">Then</span> myPath = myPath &amp; <span class="string">""</span></span><br><span class="line">    <span class="comment">'同样返回的是选中目标文件夹的绝对路径,但除了本地C盘、D盘会以"C:"形式返回外，其余路径无""需要添加 </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<p>这两种选择目标文件夹的方法，总的效果应该都不错。<br>方法-1 默认Dialog对话框左侧栏有桌面、我的文档等快捷方式，也比较符合一般人的使用习惯。<br>优点是，本层文件夹内的子文件夹全部以大图标方式列出（也可以改为列表）看起来较为轻松。<br>缺点是，如果有多层子文件夹，需要一层一层地点下去……似乎比较累一点。</p>
<p>与此相对、方法-2 是浏览器形式，点击+号可以展开、点击-号可以折叠。<br>因此也有很多人特别喜欢这一种的，尤其是有多层子文件夹时很方便。</p>
<ol>
<li>仅列出目标文件夹中所有文件。（不包括 子文件夹、不包括子文件夹中的文件）</li>
</ol>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> ListFilesTest()</span><br><span class="line">    <span class="keyword">With</span> Application.FileDialog(msoFileDialogFolderPicker)</span><br><span class="line">        <span class="keyword">If</span> .Show <span class="keyword">Then</span> myPath$ = .SelectedItems(<span class="number">1</span>) <span class="keyword">Else</span> <span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">    <span class="keyword">If</span> <span class="built_in">Right</span>(myPath, <span class="number">1</span>) &lt;&gt; <span class="string">""</span> <span class="keyword">Then</span> myPath = myPath &amp; <span class="string">""</span></span><br><span class="line">    <span class="comment">'以上选择目标文件夹以得到路径myPath</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">MsgBox</span> ListFiles(myPath)    <span class="comment">'调用FSO的ListFiles过程返回目标文件夹下的所有文件名</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> ListFiles(myPath$)</span><br><span class="line">   <span class="keyword">Set</span> fso = <span class="built_in">CreateObject</span>(<span class="string">"Scripting.FileSystemObject"</span>) <span class="comment">'打开FSO脚本、建立FSO对象实例</span></span><br><span class="line">   <span class="keyword">For</span> <span class="keyword">Each</span> f <span class="keyword">In</span> fso.GetFolder(myPath).Files  <span class="comment">'用FSO方法遍历指定文件夹内所有文件</span></span><br><span class="line">      i = i + <span class="number">1</span>: s = s &amp; vbCr &amp; f.Name            <span class="comment">'逐个列出文件名并统计文件个数 i</span></span><br><span class="line">   <span class="keyword">Next</span></span><br><span class="line">   ListFiles = i &amp; <span class="string">" Files:"</span> &amp; s  <span class="comment">'返回所有文件名的合并字符串</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br></pre></td></tr></table></figure>

<p>知识介绍：<br>Set fso = CreateObject(“Scripting.FileSystemObject”)<br>建立FSO 即【文件系统对象】的实例。</p>
<p>这以后，即可简单、直接地引用fso的各种属性（有时间可以自己慢慢研究）</p>
<p>For Each f In fso.GetFolder(myPath).Files<br>‘用FSO方法遍历指定文件夹内所有文件</p>
<p>fso.GetFolder(myPath) 是指对于路径myPath，使用FSO对象方法得到其文件夹.GetFolder属性<br>然后，对于这个指定的目标文件夹，继续返回其所有文件的属性、即.Files<br>完整的部分为： fso.GetFolder(myPath).Files</p>
<p>然后，对于这个所有文件的集合即 fso.GetFolder(myPath).Files<br>通过For……Each循环就可以遍历其中每一个文件了。</p>
<p>具体地，For Each f In 中的f变量，即为每一个文件。<br>循环中，可以使用f的各种属性。 f.Name只是其中的一种属性=文件名。</p>
<ol start="2">
<li>仅列出目标文件夹中所有子文件夹名。（不包括目标文件夹中文件、不包括子文件夹中的文件或子文件夹）</li>
</ol>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> ListFilesTest()</span><br><span class="line">    <span class="keyword">With</span> Application.FileDialog(msoFileDialogFolderPicker)</span><br><span class="line">        <span class="keyword">If</span> .Show <span class="keyword">Then</span> myPath$ = .SelectedItems(<span class="number">1</span>) <span class="keyword">Else</span> <span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">    <span class="keyword">If</span> <span class="built_in">Right</span>(myPath, <span class="number">1</span>) &lt;&gt; <span class="string">""</span> <span class="keyword">Then</span> myPath = myPath &amp; <span class="string">""</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">MsgBox</span> ListFolders(myPath)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"><span class="keyword">Function</span> ListFolders(myPath$)</span><br><span class="line">   <span class="keyword">Set</span> fso = <span class="built_in">CreateObject</span>(<span class="string">"Scripting.FileSystemObject"</span>)</span><br><span class="line">   <span class="keyword">For</span> <span class="keyword">Each</span> f <span class="keyword">In</span> fso.GetFolder(myPath).SubFolders</span><br><span class="line">      j = j + <span class="number">1</span>: t = t &amp; vbCr &amp; f.Name</span><br><span class="line">   <span class="keyword">Next</span></span><br><span class="line">   ListFolders = j &amp; <span class="string">" Folders:"</span> &amp; t</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br></pre></td></tr></table></figure>

<p>和楼上的代码ListFiles相比，差异很小，仅在于：<br>fso.GetFolder(myPath).Files<br>fso.GetFolder(myPath).SubFolders</p>
<p>即，把目标文件夹fso.GetFolder(myPath)的属性，<br>有.Files 所有文件、改为 .SubFolders 所有子文件夹</p>
<ol start="3">
<li>遍历目标文件夹内所有文件、以及所有子文件夹中的所有文件</li>
</ol>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> ListFilesTest()</span><br><span class="line">    <span class="keyword">With</span> Application.FileDialog(msoFileDialogFolderPicker)</span><br><span class="line">        <span class="keyword">If</span> .Show <span class="keyword">Then</span> myPath$ = .SelectedItems(<span class="number">1</span>) <span class="keyword">Else</span> <span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">    <span class="keyword">If</span> <span class="built_in">Right</span>(myPath, <span class="number">1</span>) &lt;&gt; <span class="string">""</span> <span class="keyword">Then</span> myPath = myPath &amp; <span class="string">""</span></span><br><span class="line">    </span><br><span class="line">    [a:a] = <span class="string">""</span>                    <span class="comment">'清空A列</span></span><br><span class="line">    <span class="keyword">Call</span> ListAllFso(myPath)   <span class="comment">'调用FSO遍历子文件夹的递归过程</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> ListAllFso(myPath$) <span class="comment">'用FSO方法遍历并列出所有文件和文件夹名的【递归过程】</span></span><br><span class="line">    <span class="keyword">Set</span> fld = <span class="built_in">CreateObject</span>(<span class="string">"Scripting.FileSystemObject"</span>).GetFolder(myPath)</span><br><span class="line">    <span class="comment">'用FSO方法得到当前路径的文件夹对象实例 注意这里的【当前路径myPath是个递归变量】</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">For</span> <span class="keyword">Each</span> f <span class="keyword">In</span> fld.Files  <span class="comment">'遍历当前文件夹内所有【文件.Files】</span></span><br><span class="line">        [a65536].<span class="keyword">End</span>(<span class="number">3</span>).Offset(<span class="number">1</span>) = f.Name <span class="comment">'在A列逐个列出文件名</span></span><br><span class="line">    <span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">For</span> <span class="keyword">Each</span> fd <span class="keyword">In</span> fld.SubFolders  <span class="comment">'遍历当前文件夹内所有【子文件夹.SubFolders】</span></span><br><span class="line">        [a65536].<span class="keyword">End</span>(<span class="number">3</span>).Offset(<span class="number">1</span>) = <span class="string">" "</span> &amp; fd.Name &amp; <span class="string">""</span>  <span class="comment">'在A列逐个列出子文件夹名</span></span><br><span class="line">        <span class="keyword">Call</span> ListAllFso(fd.Path)       <span class="comment">'注意此时的路径变量已经改变为【子文件夹的路径fd.Path】</span></span><br><span class="line">        <span class="comment">'注意重点在这里： 继续向下调用递归过程【遍历子文件夹内所有文件文件夹对象】</span></span><br><span class="line">    <span class="keyword">Next</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br></pre></td></tr></table></figure>

<p>由于很多初学者不太能理解递归算法的过程而产生畏难、抵触情绪，<br>所以下面避开递归，而采用字典记录中间结果的方法，同样来达到遍历所所有子文件的目的(不过个人觉得还不如递归呢)：</p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> ListFilesTest()</span><br><span class="line">    <span class="keyword">With</span> Application.FileDialog(msoFileDialogFolderPicker)</span><br><span class="line">        <span class="keyword">If</span> .Show <span class="keyword">Then</span> myPath$ = .SelectedItems(<span class="number">1</span>) <span class="keyword">Else</span> <span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">    <span class="keyword">If</span> <span class="built_in">Right</span>(myPath, <span class="number">1</span>) &lt;&gt; <span class="string">""</span> <span class="keyword">Then</span> myPath = myPath &amp; <span class="string">""</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">MsgBox</span> <span class="string">"List Files:"</span> &amp; vbCr &amp; <span class="built_in">Join</span>(ListAllFsoDic(myPath), vbCr)</span><br><span class="line">    <span class="built_in">MsgBox</span> <span class="string">"List SubFolders:"</span> &amp; vbCr &amp; <span class="built_in">Join</span>(ListAllFsoDic(myPath, <span class="number">1</span>), vbCr)</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> ListAllFsoDic(myPath$, Optional k = <span class="number">0</span>) <span class="comment">'使用2个字典但无需递归的遍历过程</span></span><br><span class="line">    <span class="keyword">Dim</span> i&amp;, j&amp;</span><br><span class="line">    <span class="keyword">Set</span> d1 = <span class="built_in">CreateObject</span>(<span class="string">"Scripting.Dictionary"</span>) <span class="comment">'字典d1记录子文件夹的绝对路径名    </span></span><br><span class="line">    <span class="keyword">Set</span> d2 = <span class="built_in">CreateObject</span>(<span class="string">"Scripting.Dictionary"</span>) <span class="comment">'字典d2记录文件名 （文件夹和文件分开处理）</span></span><br><span class="line"></span><br><span class="line">    d1(myPath) = <span class="string">""</span>           <span class="comment">'以当前路径myPath作为起始记录，以便开始循环检查</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">Set</span> fso = <span class="built_in">CreateObject</span>(<span class="string">"Scripting.FileSystemObject"</span>)</span><br><span class="line">    <span class="keyword">Do</span> <span class="keyword">While</span> i &lt; d1.Count</span><br><span class="line">    <span class="comment">'当字典1文件夹中有未遍历处理的key存在时进行Do循环 直到 i=d1.Count即所有子文件夹都已处理时停止</span></span><br><span class="line"></span><br><span class="line">        kr = d1.Keys <span class="comment">'取出文件夹中所有的key即所有子文件夹路径 （注意每次都要更新）</span></span><br><span class="line">        <span class="keyword">For</span> <span class="keyword">Each</span> f <span class="keyword">In</span> fso.GetFolder(kr(i)).Files <span class="comment">'遍历该子文件夹中所有文件 （注意仅从新的kr(i) 开始）</span></span><br><span class="line">            j = j + <span class="number">1</span>: d2(j) = f.Name</span><br><span class="line">           <span class="comment">'把该子文件夹内的所有文件名作为字典Item项加入字典d2 (为防止文件重名不能用key属性)</span></span><br><span class="line">        <span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line">        i = i + <span class="number">1</span> <span class="comment">'已经处理过的子文件夹数目 i +1 （避免下次产生重复处理）</span></span><br><span class="line">        <span class="keyword">For</span> <span class="keyword">Each</span> fd <span class="keyword">In</span> fso.GetFolder(kr(i - <span class="number">1</span>)).SubFolders <span class="comment">'遍历该文件夹中所有新的子文件夹</span></span><br><span class="line">            d1(fd.Path) = <span class="string">" "</span> &amp; fd.Name &amp; <span class="string">""</span> </span><br><span class="line">            <span class="comment">'把新的子文件夹路径存入字典d1以便在下一轮循环中处理</span></span><br><span class="line">        <span class="keyword">Next</span></span><br><span class="line">    <span class="keyword">Loop</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">If</span> k <span class="keyword">Then</span> ListAllFsoDic = d1.Keys <span class="keyword">Else</span> ListAllFsoDic = d2.Items</span><br><span class="line">    <span class="comment">'如果参数=1则列出字典d1中所有子文件夹的路径名 (如使用d1.Items则仅列出子文件夹名称不含路径)</span></span><br><span class="line">    <span class="comment">'如果参数=0则默认列出字典d2中Items即所有文件名 </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br></pre></td></tr></table></figure>

<ol start="4">
<li>作为本帖的特色，介绍使用VBA语句直接调用Dos中Dir命令来搜寻文件名的方法：(个人感觉不如FSO)</li>
</ol>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> ListFilesDos()</span><br><span class="line">    <span class="keyword">Set</span> myFolder = <span class="built_in">CreateObject</span>(<span class="string">"Shell.Application"</span>).BrowseForFolder(<span class="number">0</span>, <span class="string">"GetFolder"</span>, <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">If</span> <span class="keyword">Not</span> myFolder <span class="keyword">Is</span> <span class="literal">Nothing</span> <span class="keyword">Then</span> myPath$ = myFolder.Items.Item.Path <span class="keyword">Else</span> <span class="built_in">MsgBox</span> <span class="string">"Folder not Selected"</span>: <span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line">    </span><br><span class="line">    myFile$ = <span class="built_in">InputBox</span>(<span class="string">"Filename"</span>, <span class="string">"Find File"</span>, <span class="string">".xl"</span>)</span><br><span class="line">    <span class="comment">'在这里输入需要指定的关键字，可以是文件名的一部分，或指定文件类型如 ".xl"</span></span><br><span class="line">    tms = <span class="built_in">Timer</span></span><br><span class="line">    <span class="keyword">With</span> <span class="built_in">CreateObject</span>(<span class="string">"Wscript.Shell"</span>) <span class="comment">'VBA调用Dos命令</span></span><br><span class="line">        ar = <span class="built_in">Split</span>(.exec(<span class="string">"cmd /c dir /a-d /b /s "</span> &amp; <span class="built_in">Chr</span>(<span class="number">34</span>) &amp; myPath &amp; <span class="built_in">Chr</span>(<span class="number">34</span>)).StdOut.ReadAll, vbCrLf) <span class="comment">'所有文档含子文件夹</span></span><br><span class="line">        <span class="comment">'指定Dos中Dir命令的开关然后提取结果 为指定文件夹以及所含子文件夹内的所有文件的含路径全名。</span></span><br><span class="line">        s = <span class="string">"from "</span> &amp; <span class="built_in">UBound</span>(ar) &amp; <span class="string">" Files by Search time: "</span> &amp; Format(<span class="built_in">Timer</span> - tms, <span class="string">" 0.00s"</span>) &amp; <span class="string">" in: "</span> &amp; myPath</span><br><span class="line">        <span class="comment">'记录Dos中执行Dir命令的耗时</span></span><br><span class="line">        tms = <span class="built_in">Timer</span>: ar = <span class="built_in">Filter</span>(ar, myFile) <span class="comment">'然后开始按指定关键词进行筛选。可筛选文件名或文件类型</span></span><br><span class="line">        Application.StatusBar = Format(<span class="built_in">Timer</span> - tms, <span class="string">"0.00s"</span>) &amp; <span class="string">" Find "</span> &amp; <span class="built_in">UBound</span>(ar) + IIf(myFile = <span class="string">""</span>, <span class="number">0</span>, <span class="number">1</span>) &amp; <span class="string">" Files "</span> &amp; s</span><br><span class="line">        <span class="comment">'在Excel状态栏上显示执行结果以及耗时</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">    [a:a] = <span class="string">""</span>: <span class="keyword">If</span> <span class="built_in">UBound</span>(ar) &gt; <span class="number">-1</span> <span class="keyword">Then</span> [a2].Resize(<span class="number">1</span> + <span class="built_in">UBound</span>(ar)) = WorksheetFunction.Transpose(ar)</span><br><span class="line">    <span class="comment">'清空A列，然后输出结果</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<p>呵呵，Dos命令不仅简洁，而且高效。  </p>
<p>追加更正：提去文件个数统计 提取文件结果的数组ar是下标 0开始的1维数组，元素个数应该=UBound(ar)+1 【此处修正+1为ar(0)】 但实际未产生筛选时的文件结果数=UBound(ar) 无需+1 【因为Dos提取时Dir最后1个””也在结果之中】 而当指定筛选参数myFile不为空时，即产生实际筛选以后的数组ar中会排除最后的那个””,所以筛选后的统计文件结果数=UBound(ar) + 1</p>
<p>关于Dos中Dir命令的开关问题：</p>
<p>【提取文档】<br>.Exec(“cmd /c dir /a-d /b “ ………Dir返回指定文件夹下【不包括子文件夹】的所有文档名（不含文件夹）<br>.Exec(“cmd /c dir /a-d /b /s “ ………Dir返回指定文件夹下【包括子文件夹】在内的所有文档名（不含文件夹）</p>
<p>其中， /s 即 是否包含 SubFolder的意思<br>而 /a-d 是文件对象中排除文件夹目录(-d)只剩下文档的意思。</p>
<p>【提取文件夹】<br>.Exec(“cmd /c dir /a-a /b “ ………Dir返回指定文件夹下【不包括子文件夹】内的所有子文件夹名（不含文档）<br>.Exec(“cmd /c dir /a-a /b /s “ ………Dir返回指定文件夹下【包括子文件夹】内的所有子文件夹名（不含文档）<br>而 /a-a 是文件对象中排除文档(-a)只剩下文件夹目录的意思。</p>
<p>【提取文档和文件夹】<br>.Exec(“cmd /c dir /b “ ………Dir返回指定文件夹下【不包括子文件夹】的所有【文档名】和【文件夹名】<br>.Exec(“cmd /c dir /b /s “ ………Dir返回指定文件夹下【包括子文件夹】的所有【文档名】和【文件夹名】</p>
<p>呵呵，以上6种的开关组合就足够了。<br>补充：Dos Dir开关的帮助文件：</p>
<p>显示目录中的文件和子目录列表。</p>
<p>DIR [drive:][path][filename] [/A[[:]attributes]] [/B] [/C] [/D] [/L] [/N]<br> [/O[[:]sortorder]] [/P] [/Q] [/S] [/T[[:]timefield]] [/W] [/X] [/4]</p>
<p> [drive:][path][filename]<br>         指定要列出的驱动器、目录和/或文件。</p>
<p> /A      显示具有指定属性的文件。<br> attributes  D 目录          R 只读文件<br>          H 隐藏文件        A 准备存档的文件<br>          S 系统文件       - 表示“否”的前缀<br>/B      使用空格式(没有标题信息或摘要)。<br> /C      在文件大小中显示千位数分隔符。这是默认值。用 /-C 来<br>         停用分隔符显示。<br> /D      跟宽式相同，但文件是按栏分类列出的。<br> /L      用小写。<br> /N      新的长列表格式，其中文件名在最右边。<br> /O      用分类顺序列出文件。<br> sortorder  N 按名称(字母顺序)   S 按大小(从小到大)<br>          E 按扩展名(字母顺序)  D 按日期/时间(从先到后)<br>          G 组目录优先       - 颠倒顺序的前缀<br> /P      在每个信息屏幕后暂停。<br> /Q      显示文件所有者。<br> /S      显示指定目录和所有子目录中的文件。<br> /T      控制显示或用来分类的时间字符域。<br> timefield  C 创建时间<br>         A 上次访问时间<br>         W 上次写入的时间<br> /W      用宽列表格式。<br> /X      显示为非 8dot3 文件名产生的短名称。格式是 /N 的格式，<br>         短名称插在长名称前面。如果没有短名称，在其位置则<br>         显示空白。<br> /4      用四位数字显示年</p>
<p>可以在 DIRCMD 环境变量中预先设定开关。通过添加前缀 - (破折号)<br>来替代预先设定的开关。例如，/-W。</p>
<p>前面的Dir代码，是两个Do循环嵌套使用，<br>一边检查当前文件夹内的子文件夹，一边检查当前文件夹内的文件。</p>
<p>其实，Dir方法也可以这么写代码：<br>① 检查并列出所有子文件夹<br>② 然后根据需要遍历所有子文件夹中的文件</p>
<p>即，两个Do循环是分开来的。<br>但是、第2次的Do循环需要外套For循环遍历所有已知子文件夹。</p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> ListFilesDir()</span><br><span class="line">    <span class="keyword">With</span> Application.FileDialog(msoFileDialogFolderPicker)</span><br><span class="line">        <span class="keyword">If</span> .Show <span class="keyword">Then</span> myPath$ = .SelectedItems(<span class="number">1</span>) <span class="keyword">Else</span> <span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">    <span class="keyword">If</span> <span class="built_in">Right</span>(myPath, <span class="number">1</span>) &lt;&gt; <span class="string">""</span> <span class="keyword">Then</span> myPath = myPath &amp; <span class="string">""</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">MsgBox</span> <span class="built_in">Join</span>(ListAllDir(myPath), vbCr) <span class="comment">'GetAllSubFolder's File</span></span><br><span class="line">    <span class="built_in">MsgBox</span> <span class="built_in">Join</span>(ListAllDir(myPath, <span class="number">1</span>), vbCr) <span class="comment">'GetThisFolder's File</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">MsgBox</span> <span class="built_in">Join</span>(ListAllDir(myPath, <span class="number">-1</span>), vbCr) <span class="comment">'GetThisFolder's SubFolder</span></span><br><span class="line">    <span class="built_in">MsgBox</span> <span class="built_in">Join</span>(ListAllDir(myPath, <span class="number">-2</span>), vbCr) <span class="comment">'GetAllSubFolder</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">MsgBox</span> <span class="built_in">Join</span>(ListAllDir(myPath, , <span class="string">"tst"</span>), vbCr) <span class="comment">'GetAllSubFolder's SpecialFile</span></span><br><span class="line">    <span class="built_in">MsgBox</span> <span class="built_in">Join</span>(ListAllDir(myPath, <span class="number">1</span>, <span class="string">"tst"</span>), vbCr) <span class="comment">'GetThisFolder's SpecialFile</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> ListAllDir(myPath$, Optional sb&amp; = <span class="number">0</span>, Optional SpFile$ = <span class="string">""</span>)</span><br><span class="line">    <span class="keyword">Dim</span> i&amp;, j&amp;, k&amp;, myFile$</span><br><span class="line">    <span class="keyword">ReDim</span> fld(<span class="number">0</span>)</span><br><span class="line">    </span><br><span class="line">    fld(<span class="number">0</span>) = myPath</span><br><span class="line">    <span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">Resume</span> <span class="keyword">Next</span></span><br><span class="line">    <span class="keyword">Do</span></span><br><span class="line">        myFile = Dir(fld(i), vbDirectory)</span><br><span class="line">        <span class="keyword">Do</span> <span class="keyword">While</span> myFile &lt;&gt; <span class="string">""</span></span><br><span class="line">            <span class="keyword">If</span> myFile &lt;&gt; <span class="string">"."</span> <span class="keyword">And</span> myFile &lt;&gt; <span class="string">".."</span> <span class="keyword">Then</span></span><br><span class="line">                <span class="keyword">If</span> (GetAttr(fld(i) &amp; myFile) <span class="keyword">And</span> vbDirectory) = vbDirectory <span class="keyword">Then</span></span><br><span class="line">                    <span class="keyword">If</span> <span class="built_in">Err</span>.Number <span class="keyword">Then</span> <span class="built_in">Err</span>.Clear <span class="keyword">Else</span> j = j + <span class="number">1</span>: <span class="keyword">ReDim</span> <span class="keyword">Preserve</span> fld(j): fld(j) = fld(i) &amp; myFile &amp; <span class="string">""</span></span><br><span class="line">                <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">            <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">            myFile = Dir</span><br><span class="line">        <span class="keyword">Loop</span></span><br><span class="line">        <span class="keyword">If</span> sb Mod <span class="number">2</span> <span class="keyword">Then</span> <span class="keyword">Exit</span> <span class="keyword">Do</span> <span class="keyword">Else</span> i = i + <span class="number">1</span></span><br><span class="line">    <span class="keyword">Loop</span> Until i &gt; <span class="built_in">UBound</span>(fld)</span><br><span class="line">    <span class="keyword">If</span> sb &lt; <span class="number">0</span> <span class="keyword">And</span> <span class="built_in">Len</span>(SpFile) = <span class="number">0</span> <span class="keyword">Then</span> ListAllDir = fld: <span class="keyword">Exit</span> <span class="keyword">Function</span></span><br><span class="line">    <span class="comment">'以上为止，遍历检查并列出指定目标文件夹中、所有的子文件夹。</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">'以下为遍历已获得的子文件夹数组fld 然后Dir循环检查其中所有的文件</span></span><br><span class="line">    <span class="keyword">ReDim</span> file(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">For</span> i = <span class="number">0</span> <span class="keyword">To</span> <span class="built_in">UBound</span>(fld)</span><br><span class="line">        myFile = Dir(fld(i), vbDirectory)</span><br><span class="line">        <span class="keyword">Do</span> <span class="keyword">While</span> myFile &lt;&gt; <span class="string">""</span></span><br><span class="line">            <span class="keyword">If</span> myFile &lt;&gt; <span class="string">"."</span> <span class="keyword">And</span> myFile &lt;&gt; <span class="string">".."</span> <span class="keyword">Then</span></span><br><span class="line">                <span class="keyword">If</span> <span class="keyword">Not</span> (GetAttr(fld(i) &amp; myFile) <span class="keyword">And</span> vbDirectory) = vbDirectory <span class="keyword">Then</span></span><br><span class="line">                    <span class="keyword">If</span> SpFile = <span class="string">""</span> <span class="keyword">Then</span></span><br><span class="line">                        file(k) = myFile: k = k + <span class="number">1</span>: <span class="keyword">ReDim</span> <span class="keyword">Preserve</span> file(k)</span><br><span class="line">                    <span class="keyword">Else</span></span><br><span class="line">                        <span class="keyword">If</span> <span class="built_in">InStr</span>(myFile, SpFile) <span class="keyword">Then</span> file(k) = myFile: k = k + <span class="number">1</span>: <span class="keyword">ReDim</span> <span class="keyword">Preserve</span> file(k)</span><br><span class="line">                    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">                <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">            <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">            myFile = Dir</span><br><span class="line">        <span class="keyword">Loop</span></span><br><span class="line">    <span class="keyword">Next</span></span><br><span class="line">    ListAllDir = file</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br></pre></td></tr></table></figure>

<p>一般说，还是第1种两个Do嵌套的方法好……虽然代码中需要同时处理文件夹和文件名，但Do循环比较高效一些。</p>
<p>第2种方法也并非全无是处。<br>当处理文件为重点时，以第2种方法比较好。</p>
<p>Dos版 加入Dir各种参数以后的完整代码：</p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> ListFilesDos()</span><br><span class="line">    myMode&amp; = Val(<span class="built_in">InputBox</span>(<span class="string">"Search Mode:-3 To 3"</span>, <span class="string">"Find File"</span>, <span class="number">0</span>)) <span class="comment">'指定Dos Dir的查找开关、返回模式</span></span><br><span class="line">    <span class="comment">'奇数为不含子文件夹、偶数为含子文件夹 / 负数为目录、正数为文档 / &gt;1为文档及目录</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">If</span> myMode &gt; <span class="number">-3</span> <span class="keyword">Then</span></span><br><span class="line">        myFile$ = <span class="built_in">InputBox</span>(<span class="string">"Part of Filename or Filetype as "".xl"""</span>, <span class="string">"Find File"</span>, <span class="string">".xl"</span>)</span><br><span class="line">        <span class="comment">'输入指定关键字，可以是文件(文档和目录)名称中的任意部分，或指定文件类型如 ".xl"</span></span><br><span class="line">    </span><br><span class="line">        <span class="keyword">Set</span> myFolder = <span class="built_in">CreateObject</span>(<span class="string">"Shell.Application"</span>).BrowseForFolder(<span class="number">0</span>, <span class="string">"GetFolder"</span>, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">If</span> <span class="keyword">Not</span> myFolder <span class="keyword">Is</span> <span class="literal">Nothing</span> <span class="keyword">Then</span> myPath$ = myFolder.Items.Item.path <span class="keyword">Else</span> <span class="built_in">MsgBox</span> <span class="string">"Folder not Selected"</span>: <span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line">        <span class="comment">'浏览列表指定查找目录</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">    tms = <span class="built_in">Timer</span></span><br><span class="line">    <span class="keyword">With</span> <span class="built_in">CreateObject</span>(<span class="string">"Wscript.Shell"</span>) <span class="comment">'VBA调用Dos命令</span></span><br><span class="line">　　cmdStr = Choose(myMode + <span class="number">4</span>, <span class="string">"/? "</span>, <span class="string">"/a:d /b /s "</span>, <span class="string">"/a:d /b "</span>, <span class="string">"/a:a /b /s "</span>, <span class="string">"/a:a /b "</span>, <span class="string">"/b /s "</span>, <span class="string">"/b "</span>, <span class="string">"/a:a /o:e /o:n /s "</span>, <span class="string">"/a:a /o:e /o:n "</span>, <span class="string">"/a:d /o:e /o:n /s "</span>, <span class="string">"/a:d /o:e /o:n "</span>)</span><br><span class="line">        ar = <span class="built_in">Split</span>(.exec(<span class="string">"cmd /c dir "</span> &amp; cmdStr &amp; <span class="built_in">Chr</span>(<span class="number">34</span>) &amp; myPath &amp; <span class="built_in">Chr</span>(<span class="number">34</span>)).StdOut.ReadAll, vbCrLf)</span><br><span class="line">        <span class="comment">'指定Dos中Dir命令的开关然后提取结果 为指定文件夹以及所含子文件夹内的所有文件的含路径全名。</span></span><br><span class="line">        </span><br><span class="line">        s = <span class="built_in">UBound</span>(ar) &amp; <span class="string">" Files by Search time: "</span> &amp; Format(<span class="built_in">Timer</span> - tms, <span class="string">" 0.00s"</span>) &amp; <span class="string">" in: "</span> &amp; myPath</span><br><span class="line">        Application.StatusBar = <span class="string">" Find "</span> &amp; s: tms = <span class="built_in">Timer</span> <span class="comment">'记录Dos中执行Dir命令的耗时 并在Excel状态栏上显示</span></span><br><span class="line">        <span class="keyword">If</span> myFile &lt;&gt; <span class="string">""</span> <span class="keyword">Then</span> <span class="comment">'如指定了匹配关键字则</span></span><br><span class="line">            ar = <span class="built_in">Filter</span>(ar, myFile) <span class="comment">'按指定关键词myFile进行筛选。可筛选文件名或文件类型、然后在Excel状态栏上显示结果</span></span><br><span class="line">            Application.StatusBar = Format(<span class="built_in">Timer</span> - tms, <span class="string">"0.00s"</span>) &amp; <span class="string">" Find "</span> &amp; <span class="number">1</span> + <span class="built_in">UBound</span>(ar) &amp; <span class="string">" Files from "</span> &amp; s</span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">    [a:a] = <span class="string">""</span>: <span class="keyword">If</span> <span class="built_in">UBound</span>(ar) &gt; <span class="number">-1</span> <span class="keyword">Then</span> [a2].Resize(<span class="number">1</span> + <span class="built_in">UBound</span>(ar)) = WorksheetFunction.Transpose(ar)</span><br><span class="line"><span class="comment">'    清空A列，然后输出结果</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<p>为大家看得清楚明白，把各种开关写成Select形式：</p>
<p>​     Select Case myMode ‘根据开关模式设置Dos Dir的开关参数<br>​        Case -3<br>​          cmdStr = “cmd /c dir /?” ‘列出Dir各个参数开关的帮助文件<br>​        Case -2<br>​          cmdStr = “cmd /c dir /a-a /b /s “ &amp; Chr(34) &amp; myPath &amp; Chr(34) ‘目录不含文档[/a-a]含子文件夹<br>​        Case -1<br>​          cmdStr = “cmd /c dir /a-a /b “ &amp; Chr(34) &amp; myPath &amp; Chr(34) ‘目录不含文档<a href="不含子文件夹">/a-a</a><br>​        Case 0<br>​          cmdStr = “cmd /c dir /a-d /b /s “ &amp; Chr(34) &amp; myPath &amp; Chr(34) ‘文档不含目录[/a-d]含子文件夹<br>​        Case 1<br>​          cmdStr = “cmd /c dir /a-d /b “ &amp; Chr(34) &amp; myPath &amp; Chr(34) ‘文档不含目录<a href="不含子文件夹">/a-d</a><br>​        Case 2<br>​          cmdStr = “cmd /c dir /b /s “ &amp; Chr(34) &amp; myPath &amp; Chr(34) ‘所有文档及目录含子文件夹<br>​        Case 3<br>​          cmdStr = “cmd /c dir /a-d /b “ &amp; Chr(34) &amp; myPath &amp; Chr(34) ‘所有文档及目录(不含子文件夹)<br>​     End Select</p>
<p>但实际代码中用Choose语句简化。</p>
<ol start="5">
<li>FSO 递归方法实现各种指定搜寻的完整代码：</li>
</ol>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">Dim</span> jg(), k&amp;, tms# <span class="comment">'因为是递归，所以事先指定存放结果的公用变量数组jg以及计数器k和起始时间tms</span></span><br><span class="line"><span class="keyword">Sub</span> ListFilesFso()</span><br><span class="line">    sb&amp; = <span class="built_in">InputBox</span>(<span class="string">"Search Type: AllFiles=0/Files=1/Folder=-1/All Folder=-2"</span>, <span class="string">"Find Files"</span>, <span class="number">0</span>) <span class="comment">'选定返回模式</span></span><br><span class="line">    SpFile$ = <span class="built_in">InputBox</span>(<span class="string">"匹配文件名或文件类型"</span>, <span class="string">"Find Files"</span>, <span class="string">".xl"</span>) <span class="comment">'指定匹配要求，留空则匹配全部</span></span><br><span class="line">    <span class="keyword">If</span> SpFile Like <span class="string">".*"</span> <span class="keyword">Then</span> SpFile = <span class="built_in">LCase</span>(SpFile) &amp; <span class="string">"*"</span> <span class="comment">'如果指定了文件类型则一律转换为大写字母方便比较</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">With</span> Application.FileDialog(msoFileDialogFolderPicker)</span><br><span class="line">        <span class="keyword">If</span> .Show <span class="keyword">Then</span> myPath$ = .SelectedItems(<span class="number">1</span>) <span class="keyword">Else</span> <span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">    <span class="keyword">If</span> <span class="built_in">Right</span>(myPath, <span class="number">1</span>) &lt;&gt; <span class="string">""</span> <span class="keyword">Then</span> myPath = myPath &amp; <span class="string">""</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">ReDim</span> jg(<span class="number">65535</span>, <span class="number">3</span>)</span><br><span class="line">    jg(<span class="number">0</span>, <span class="number">0</span>) = <span class="string">"Ext"</span>: jg(<span class="number">0</span>, <span class="number">1</span>) = IIf(sb &lt; <span class="number">0</span>, IIf(<span class="built_in">Len</span>(SpFile), <span class="string">"Filename"</span>, <span class="string">"No"</span>), <span class="string">"Filename"</span>)</span><br><span class="line">    jg(<span class="number">0</span>, <span class="number">2</span>) = <span class="string">"Folder"</span>: jg(<span class="number">0</span>, <span class="number">3</span>) = <span class="string">"Path"</span></span><br><span class="line">    <span class="comment">'定义存放文件名结果的数组jg 、并写入标题</span></span><br><span class="line">    tms = <span class="built_in">Timer</span>: k = <span class="number">0</span>: <span class="keyword">Call</span> ListAllFso(myPath, sb, SpFile) <span class="comment">'调用递归过程检查指定文件夹及其子文件夹</span></span><br><span class="line">    <span class="keyword">If</span> sb &lt; <span class="number">0</span> <span class="keyword">And</span> <span class="built_in">Len</span>(SpFile) = <span class="number">0</span> <span class="keyword">Then</span> Application.StatusBar = <span class="string">"Get "</span> &amp; k &amp; <span class="string">" Folders."</span></span><br><span class="line">    [a1].CurrentRegion = <span class="string">""</span>: [a1].Resize(k + <span class="number">1</span>, <span class="number">4</span>) = jg: [a1].CurrentRegion.AutoFilter Field:=<span class="number">1</span></span><br><span class="line">    <span class="comment">'输出结果到工作表，并启用筛选模式</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> ListAllFso(myPath$, Optional sb&amp; = <span class="number">0</span>, Optional SpFile$ = <span class="string">""</span>) <span class="comment">'递归检查子文件夹的过程代码</span></span><br><span class="line">    <span class="keyword">Set</span> fld = <span class="built_in">CreateObject</span>(<span class="string">"Scripting.FileSystemObject"</span>).GetFolder(myPath)</span><br><span class="line">    <span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">Resume</span> <span class="keyword">Next</span></span><br><span class="line">    <span class="keyword">If</span> sb &gt;= <span class="number">0</span> <span class="keyword">Or</span> <span class="built_in">Len</span>(SpFile) <span class="keyword">Then</span> <span class="comment">'如果模式为0或1、或指定了匹配文件要求，则遍历各个文件</span></span><br><span class="line">        <span class="keyword">For</span> <span class="keyword">Each</span> f <span class="keyword">In</span> fld.Files <span class="comment">'用FSO方法遍历文件.Files</span></span><br><span class="line">            t = <span class="literal">False</span> <span class="comment">'匹配状态初始化</span></span><br><span class="line">            n = <span class="built_in">InStrRev</span>(f.Name, <span class="string">"."</span>): fnm = <span class="built_in">Left</span>(f.Name, n - <span class="number">1</span>): x = <span class="built_in">LCase</span>(<span class="built_in">Mid</span>(f.Name, n))</span><br><span class="line">            <span class="keyword">If</span> <span class="built_in">Err</span>.Number <span class="keyword">Then</span> <span class="built_in">Err</span>.Clear</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">If</span> SpFile = <span class="string">" "</span> <span class="keyword">Then</span> <span class="comment">'Space 如果匹配要求为空则匹配全部</span></span><br><span class="line">                t = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">ElseIf</span> SpFile Like <span class="string">".*"</span> <span class="keyword">Then</span> <span class="comment">'如果匹配要求为文件类型则</span></span><br><span class="line">                <span class="keyword">If</span> x Like SpFile <span class="keyword">Then</span> t = <span class="literal">True</span> <span class="comment">'当文件符合文件类型要求时匹配，否则不匹配</span></span><br><span class="line">            <span class="keyword">Else</span> <span class="comment">'否则为需要匹配文件名称中的一部分</span></span><br><span class="line">                <span class="keyword">If</span> <span class="built_in">InStr</span>(fnm, SpFile) <span class="keyword">Then</span> t = <span class="literal">True</span> <span class="comment">'如果匹配则状态为True</span></span><br><span class="line">            <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">            <span class="keyword">If</span> t <span class="keyword">Then</span> k = k + <span class="number">1</span>: jg(k, <span class="number">0</span>) = x: jg(k, <span class="number">1</span>) = <span class="string">"'"</span> &amp; fnm: jg(k, <span class="number">2</span>) = fld.Name: jg(k, <span class="number">3</span>) = fld.Path</span><br><span class="line">        <span class="keyword">Next</span></span><br><span class="line">        Application.StatusBar = Format(<span class="built_in">Timer</span> - tms, <span class="string">"0.0s"</span>) &amp; <span class="string">" Get "</span> &amp; k &amp; <span class="string">" Files , Searching in Folder ... "</span> &amp; fld.Path</span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">For</span> <span class="keyword">Each</span> fd <span class="keyword">In</span> fld.SubFolders <span class="comment">'然后遍历检查所有子文件夹.SubFolders</span></span><br><span class="line">        <span class="keyword">If</span> sb &lt; <span class="number">0</span> <span class="keyword">And</span> <span class="built_in">Len</span>(SpFile) = <span class="number">0</span> <span class="keyword">Then</span> k = k + <span class="number">1</span>: jg(k, <span class="number">0</span>) = <span class="string">"fld"</span>: jg(k, <span class="number">1</span>) = k: jg(k, <span class="number">2</span>) = fd.Name: jg(k, <span class="number">3</span>) = fld.Path</span><br><span class="line">        <span class="keyword">If</span> sb Mod <span class="number">2</span> = <span class="number">0</span> <span class="keyword">Then</span> <span class="keyword">Call</span> ListAllFso(fd.Path, sb, SpFile)</span><br><span class="line">    <span class="keyword">Next</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br></pre></td></tr></table></figure>

<ol start="6">
<li>定义的写法——补课</li>
</ol>
<p>关于变量类型缩写的快速记忆：</p>
<p>! = Single 单精度小数……因为 ! 笔画只是1竖单笔画，所以记住为【单精度】<br># = Double 双精度小数 …因为 # 笔画是2横2竖，所以记住为【双精度】<br>@ = Currency 货币型4位小数 …现实中大家也常用@符号代表价格、单价，所以记住为【货币型小数】<br>$ = String 文本字符串 …因为 String第1个字母是 S 所以记住为【美元s=String 文本字符串】</p>
<p>% = Integer 整数 ……因为 % 是百分比符号我们把它联想为较少的整数【整型数值】<br>&amp; = Long 整数 ……因为 &amp; 可以看做是Long首字母L的花体字 所以记住为【长整型数值】</p>
<p>呵呵，这样稍稍动脑筋记忆一下，以后就可以简单使用了。<br>比如这样子：<br>Dim i&amp;, j&amp;, k&amp;, l&amp;, l1&amp;, l2&amp;, m&amp;, n&amp;, s$, w1$, w2$</p>
<p>如果很正规地写，成为：<br>  Dim i As Long<br>  Dim j As Long<br>  Dim k As Long<br>  Dim l As Long<br>  Dim l1 As Long<br>  Dim l2 As Long<br>  Dim m As Long<br>  Dim n As Long</p>
<p>  Dim s As String<br>  Dim w1 As String<br>  Dim w2 As String</p>
<p>这样就会很长。</p>
<p>或者写在一起时，横向会很长也不方便<br>  Dim i As Long, j As Long, k As Long, l As Long, l1 As Long, l2 As Long, m As Long, n As Long<br>  Dim s As String, w1 As String, w2 As String</p>
<p>…………<br>以上只是个人习惯而已。</p>
<p>但是，新手千万不要这样子：<br>  Dim i, j, k, l, l1, l2, m, n As Long<br>  Dim s, w1, w2 As String</p>
<p>这样做，只有最后一个蓝色的变量被正确定义了变量类型，<br>其它的都会被作为Variant变量使用……或许不影响使用，但至少违背了作者的初衷。所以不好。</p>
<p>如果需要操作文件以及文件内的各个工作表Sheet，那么当然首先要打开该文件。</p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Function</span> ListFiles(myPath$)</span><br><span class="line">   <span class="keyword">Set</span> Fso = <span class="built_in">CreateObject</span>(<span class="string">"Scripting.FileSystemObject"</span>)</span><br><span class="line">   <span class="keyword">For</span> <span class="keyword">Each</span> f <span class="keyword">In</span> Fso.GetFolder(myPath).Files</span><br><span class="line">      Workbooks.Open (f) <span class="comment">'打开文件</span></span><br><span class="line">      <span class="keyword">For</span> <span class="keyword">Each</span> sh <span class="keyword">In</span> ActiveWorkbook.Sheets <span class="comment">'遍历该文件的所有工作表</span></span><br><span class="line">        sh.Activate <span class="comment">'激活工作表</span></span><br><span class="line">        </span><br><span class="line">      <span class="keyword">Next</span></span><br><span class="line">      ActiveWorkbook.Close <span class="comment">'关闭文件</span></span><br><span class="line">   <span class="keyword">Next</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br></pre></td></tr></table></figure>



<p>【Dir 使用方法】</p>
<p>myPath = “c:&quot;  ‘首先设定目标文件夹，注意末尾必须是【\】文件夹符号。</p>
<p>myFile = Dir(myPath, vbDirectory)  ‘第一次使用Dir函数时，必须完整输入路径和检索要求。<br>                                 ‘ 如果直接使用Dir不带参数则会报错。</p>
<p>Do While myFile &lt;&gt; “”  ‘开始Do不定循环、直至在本文件夹内没有找到文档/文件夹而返回空白时停止。</p>
<p>  If myFile &lt;&gt; “.” And myFile &lt;&gt; “..” Then<br>     ‘此If判断为忽略 当前文件夹”.”以及忽略上级文件夹”..”</p>
<p>​     If (GetAttr(MyPath &amp; MyName) And vbDirectory) = vbDirectory Then<br>​        ‘接下来的If判断是：通过二进制的位比较计算结果= vbDirectory 来判断这是一个文件夹。<br>​        Debug.Print myFile      ‘判断为文件夹时的处理<br>​     Else ‘否则为文档<br>​        Debug.Print myFile     ‘判断为文档时的处理。<br>​     End If<br>  End If<br>  myFile = Dir   ‘继续调用【不带路径参数的Dir函数】 这样就能得到下一个搜寻结果。<br>Loop</p>
<h2 id="四、本人的代码"><a href="#四、本人的代码" class="headerlink" title="四、本人的代码"></a>四、本人的代码</h2><ol>
<li>之前平浙信项目折腾从excel到word，批量替换多个变量，遍历文件夹，但是开始自己还不会，只好在代码内复制粘贴，主要是为了满足功能，就这已经帮我们团队节省了80%以上的人力，先把丑陋的代码放在这里，命名v1.1：</li>
</ol>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> CommandButton1_Click()</span><br><span class="line"></span><br><span class="line">   <span class="keyword">Dim</span> Word对象 As <span class="keyword">New</span> Word.Application, 当前路径, 导出文件名, 导出路径文件名, i, j</span><br><span class="line">   <span class="keyword">Dim</span> Str1, Str2</span><br><span class="line">   当前路径 = ThisWorkbook.Path</span><br><span class="line">   最后行号 = Sheets(<span class="string">"数据"</span>).Range(<span class="string">"B65536"</span>).<span class="keyword">End</span>(xlUp).Row</span><br><span class="line">   判断 = <span class="number">0</span></span><br><span class="line">   <span class="keyword">For</span> i = <span class="number">3</span> <span class="keyword">To</span> 最后行号</span><br><span class="line">      导出文件名 = <span class="string">"信托合同：6份，每份骑缝章1各，签署页公章和法人章各1个，附件6预留印鉴公章和法人各1个"</span></span><br><span class="line">      FileCopy 当前路径 &amp; <span class="string">"\信托合同：6份，每份骑缝章1各，签署页公章和法人章各1个，附件6预留印鉴公章和法人各1个.doc"</span>, 当前路径 &amp; <span class="string">"\"</span> &amp; 导出文件名 &amp; <span class="string">"("</span> &amp; Sheets(<span class="string">"数据"</span>).Range(<span class="string">"B"</span> &amp; i) &amp; <span class="string">").doc"</span></span><br><span class="line">      导出路径文件名 = 当前路径 &amp; <span class="string">"\"</span> &amp; 导出文件名 &amp; <span class="string">"("</span> &amp; Sheets(<span class="string">"数据"</span>).Range(<span class="string">"B"</span> &amp; i) &amp; <span class="string">").doc"</span></span><br><span class="line">      <span class="keyword">With</span> Word对象</span><br><span class="line">        .Documents.Open 导出路径文件名</span><br><span class="line">        .Visible = <span class="literal">False</span></span><br><span class="line">        .Selection.HomeKey Unit:=wdStory <span class="comment">'光标置于文件首</span></span><br><span class="line">        <span class="keyword">With</span> .Selection.Find <span class="comment">'填写文字数据</span></span><br><span class="line">            <span class="keyword">For</span> j = <span class="number">1</span> <span class="keyword">To</span> <span class="number">48</span></span><br><span class="line">             Str1 = <span class="string">"数据"</span> &amp; Format(j, <span class="string">"000"</span>)</span><br><span class="line">             Str2 = Sheets(<span class="string">"数据"</span>).Cells(i, j + <span class="number">1</span>)</span><br><span class="line">             .Text = Str1</span><br><span class="line">             .Replacement.Text = Str2 <span class="comment">'替换字符串</span></span><br><span class="line">             .<span class="keyword">Execute</span> <span class="built_in">Replace</span>:=wdReplaceAll <span class="comment">'全部替换</span></span><br><span class="line">            <span class="keyword">Next</span> j</span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">        .ActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageHeader <span class="comment">'设置位置在页眉</span></span><br><span class="line">        Str1 = <span class="string">"数据001"</span></span><br><span class="line">        Str2 = Sheets(<span class="string">"数据2"</span>).Cells(i, <span class="number">2</span>)</span><br><span class="line">        .Selection.HomeKey Unit:=wdStory <span class="comment">'光标置于文件首</span></span><br><span class="line">        <span class="keyword">If</span> .Selection.Find.<span class="keyword">Execute</span>(Str1) <span class="keyword">Then</span> <span class="comment">'查找到指定字符串</span></span><br><span class="line">           .Selection.Font.Color = wdColorAutomatic <span class="comment">'字符为自动颜色</span></span><br><span class="line">           .Selection.Text = Str2 <span class="comment">'替换字符串</span></span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">      <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">      Word对象.Documents.Save</span><br><span class="line">      Word对象.Quit</span><br><span class="line">      <span class="keyword">Set</span> Word对象 = <span class="literal">Nothing</span></span><br><span class="line">   <span class="keyword">Next</span> i</span><br><span class="line">    </span><br><span class="line">   <span class="keyword">For</span> i = <span class="number">3</span> <span class="keyword">To</span> 最后行号</span><br><span class="line">      导出文件名 = <span class="string">"本期区块链应收款清单：4份，总行公章+法人章+骑缝"</span></span><br><span class="line">      FileCopy 当前路径 &amp; <span class="string">"\本期区块链应收款清单：4份，总行公章+法人章+骑缝.doc"</span>, 当前路径 &amp; <span class="string">"\"</span> &amp; 导出文件名 &amp; <span class="string">"("</span> &amp; Sheets(<span class="string">"数据"</span>).Range(<span class="string">"B"</span> &amp; i) &amp; <span class="string">").doc"</span></span><br><span class="line">      导出路径文件名 = 当前路径 &amp; <span class="string">"\"</span> &amp; 导出文件名 &amp; <span class="string">"("</span> &amp; Sheets(<span class="string">"数据"</span>).Range(<span class="string">"B"</span> &amp; i) &amp; <span class="string">").doc"</span></span><br><span class="line">      <span class="keyword">With</span> Word对象</span><br><span class="line">        .Documents.Open 导出路径文件名</span><br><span class="line">        .Visible = <span class="literal">False</span></span><br><span class="line">        .Selection.HomeKey Unit:=wdStory <span class="comment">'光标置于文件首</span></span><br><span class="line">        <span class="keyword">With</span> .Selection.Find <span class="comment">'填写文字数据</span></span><br><span class="line">            <span class="keyword">For</span> j = <span class="number">1</span> <span class="keyword">To</span> <span class="number">48</span></span><br><span class="line">             Str1 = <span class="string">"数据"</span> &amp; Format(j, <span class="string">"000"</span>)</span><br><span class="line">             Str2 = Sheets(<span class="string">"数据"</span>).Cells(i, j + <span class="number">1</span>)</span><br><span class="line">             .Text = Str1</span><br><span class="line">             .Replacement.Text = Str2 <span class="comment">'替换字符串</span></span><br><span class="line">             .<span class="keyword">Execute</span> <span class="built_in">Replace</span>:=wdReplaceAll <span class="comment">'全部替换</span></span><br><span class="line">            <span class="keyword">Next</span> j</span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">        .ActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageHeader <span class="comment">'设置位置在页眉</span></span><br><span class="line">        Str1 = <span class="string">"数据001"</span></span><br><span class="line">        Str2 = Sheets(<span class="string">"数据2"</span>).Cells(i, <span class="number">2</span>)</span><br><span class="line">        .Selection.HomeKey Unit:=wdStory <span class="comment">'光标置于文件首</span></span><br><span class="line">        <span class="keyword">If</span> .Selection.Find.<span class="keyword">Execute</span>(Str1) <span class="keyword">Then</span> <span class="comment">'查找到指定字符串</span></span><br><span class="line">           .Selection.Font.Color = wdColorAutomatic <span class="comment">'字符为自动颜色</span></span><br><span class="line">           .Selection.Text = Str2 <span class="comment">'替换字符串</span></span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">      <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">      Word对象.Documents.Save</span><br><span class="line">      Word对象.Quit</span><br><span class="line">      <span class="keyword">Set</span> Word对象 = <span class="literal">Nothing</span></span><br><span class="line">   <span class="keyword">Next</span> i</span><br><span class="line">       </span><br><span class="line">   <span class="keyword">For</span> i = <span class="number">3</span> <span class="keyword">To</span> 最后行号</span><br><span class="line">      导出文件名 = <span class="string">"风险说明书：6份，总行公章、法人章+骑缝"</span></span><br><span class="line">      FileCopy 当前路径 &amp; <span class="string">"\风险说明书：6份，总行公章、法人章+骑缝.doc"</span>, 当前路径 &amp; <span class="string">"\"</span> &amp; 导出文件名 &amp; <span class="string">"("</span> &amp; Sheets(<span class="string">"数据"</span>).Range(<span class="string">"B"</span> &amp; i) &amp; <span class="string">").doc"</span></span><br><span class="line">      导出路径文件名 = 当前路径 &amp; <span class="string">"\"</span> &amp; 导出文件名 &amp; <span class="string">"("</span> &amp; Sheets(<span class="string">"数据"</span>).Range(<span class="string">"B"</span> &amp; i) &amp; <span class="string">").doc"</span></span><br><span class="line">      <span class="keyword">With</span> Word对象</span><br><span class="line">        .Documents.Open 导出路径文件名</span><br><span class="line">        .Visible = <span class="literal">False</span></span><br><span class="line">        .Selection.HomeKey Unit:=wdStory <span class="comment">'光标置于文件首</span></span><br><span class="line">        <span class="keyword">With</span> .Selection.Find <span class="comment">'填写文字数据</span></span><br><span class="line">            <span class="keyword">For</span> j = <span class="number">1</span> <span class="keyword">To</span> <span class="number">48</span></span><br><span class="line">             Str1 = <span class="string">"数据"</span> &amp; Format(j, <span class="string">"000"</span>)</span><br><span class="line">             Str2 = Sheets(<span class="string">"数据"</span>).Cells(i, j + <span class="number">1</span>)</span><br><span class="line">             .Text = Str1</span><br><span class="line">             .Replacement.Text = Str2 <span class="comment">'替换字符串</span></span><br><span class="line">             .<span class="keyword">Execute</span> <span class="built_in">Replace</span>:=wdReplaceAll <span class="comment">'全部替换</span></span><br><span class="line">            <span class="keyword">Next</span> j</span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">        .ActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageHeader <span class="comment">'设置位置在页眉</span></span><br><span class="line">        Str1 = <span class="string">"数据001"</span></span><br><span class="line">        Str2 = Sheets(<span class="string">"数据2"</span>).Cells(i, <span class="number">2</span>)</span><br><span class="line">        .Selection.HomeKey Unit:=wdStory <span class="comment">'光标置于文件首</span></span><br><span class="line">        <span class="keyword">If</span> .Selection.Find.<span class="keyword">Execute</span>(Str1) <span class="keyword">Then</span> <span class="comment">'查找到指定字符串</span></span><br><span class="line">           .Selection.Font.Color = wdColorAutomatic <span class="comment">'字符为自动颜色</span></span><br><span class="line">           .Selection.Text = Str2 <span class="comment">'替换字符串</span></span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">      <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">      Word对象.Documents.Save</span><br><span class="line">      Word对象.Quit</span><br><span class="line">      <span class="keyword">Set</span> Word对象 = <span class="literal">Nothing</span></span><br><span class="line">   <span class="keyword">Next</span> i</span><br><span class="line">       </span><br><span class="line">   <span class="keyword">For</span> i = <span class="number">3</span> <span class="keyword">To</span> 最后行号</span><br><span class="line">      导出文件名 = <span class="string">"信托说明书"</span></span><br><span class="line">      FileCopy 当前路径 &amp; <span class="string">"\信托说明书.doc"</span>, 当前路径 &amp; <span class="string">"\"</span> &amp; 导出文件名 &amp; <span class="string">"("</span> &amp; Sheets(<span class="string">"数据"</span>).Range(<span class="string">"B"</span> &amp; i) &amp; <span class="string">").doc"</span></span><br><span class="line">      导出路径文件名 = 当前路径 &amp; <span class="string">"\"</span> &amp; 导出文件名 &amp; <span class="string">"("</span> &amp; Sheets(<span class="string">"数据"</span>).Range(<span class="string">"B"</span> &amp; i) &amp; <span class="string">").doc"</span></span><br><span class="line">      <span class="keyword">With</span> Word对象</span><br><span class="line">        .Documents.Open 导出路径文件名</span><br><span class="line">        .Visible = <span class="literal">False</span></span><br><span class="line">        .Selection.HomeKey Unit:=wdStory <span class="comment">'光标置于文件首</span></span><br><span class="line">        <span class="keyword">With</span> .Selection.Find <span class="comment">'填写文字数据</span></span><br><span class="line">            <span class="keyword">For</span> j = <span class="number">1</span> <span class="keyword">To</span> <span class="number">48</span></span><br><span class="line">             Str1 = <span class="string">"数据"</span> &amp; Format(j, <span class="string">"000"</span>)</span><br><span class="line">             Str2 = Sheets(<span class="string">"数据"</span>).Cells(i, j + <span class="number">1</span>)</span><br><span class="line">             .Text = Str1</span><br><span class="line">             .Replacement.Text = Str2 <span class="comment">'替换字符串</span></span><br><span class="line">             .<span class="keyword">Execute</span> <span class="built_in">Replace</span>:=wdReplaceAll <span class="comment">'全部替换</span></span><br><span class="line">            <span class="keyword">Next</span> j</span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">        .ActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageHeader <span class="comment">'设置位置在页眉</span></span><br><span class="line">        Str1 = <span class="string">"数据001"</span></span><br><span class="line">        Str2 = Sheets(<span class="string">"数据2"</span>).Cells(i, <span class="number">2</span>)</span><br><span class="line">        .Selection.HomeKey Unit:=wdStory <span class="comment">'光标置于文件首</span></span><br><span class="line">        <span class="keyword">If</span> .Selection.Find.<span class="keyword">Execute</span>(Str1) <span class="keyword">Then</span> <span class="comment">'查找到指定字符串</span></span><br><span class="line">           .Selection.Font.Color = wdColorAutomatic <span class="comment">'字符为自动颜色</span></span><br><span class="line">           .Selection.Text = Str2 <span class="comment">'替换字符串</span></span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">      <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">      Word对象.Documents.Save</span><br><span class="line">      Word对象.Quit</span><br><span class="line">      <span class="keyword">Set</span> Word对象 = <span class="literal">Nothing</span></span><br><span class="line">   <span class="keyword">Next</span> i</span><br><span class="line">       </span><br><span class="line">   <span class="keyword">For</span> i = <span class="number">3</span> <span class="keyword">To</span> 最后行号</span><br><span class="line">        导出文件名 = <span class="string">"资产服务协议：5份，总行公章、法人章+骑缝"</span></span><br><span class="line">      FileCopy 当前路径 &amp; <span class="string">"\资产服务协议：5份，总行公章、法人章+骑缝.doc"</span>, 当前路径 &amp; <span class="string">"\"</span> &amp; 导出文件名 &amp; <span class="string">"("</span> &amp; Sheets(<span class="string">"数据"</span>).Range(<span class="string">"B"</span> &amp; i) &amp; <span class="string">").doc"</span></span><br><span class="line">      导出路径文件名 = 当前路径 &amp; <span class="string">"\"</span> &amp; 导出文件名 &amp; <span class="string">"("</span> &amp; Sheets(<span class="string">"数据"</span>).Range(<span class="string">"B"</span> &amp; i) &amp; <span class="string">").doc"</span></span><br><span class="line">      <span class="keyword">With</span> Word对象</span><br><span class="line">        .Documents.Open 导出路径文件名</span><br><span class="line">        .Visible = <span class="literal">False</span></span><br><span class="line">        .Selection.HomeKey Unit:=wdStory <span class="comment">'光标置于文件首</span></span><br><span class="line">        <span class="keyword">With</span> .Selection.Find <span class="comment">'填写文字数据</span></span><br><span class="line">            <span class="keyword">For</span> j = <span class="number">1</span> <span class="keyword">To</span> <span class="number">48</span></span><br><span class="line">             Str1 = <span class="string">"数据"</span> &amp; Format(j, <span class="string">"000"</span>)</span><br><span class="line">             Str2 = Sheets(<span class="string">"数据"</span>).Cells(i, j + <span class="number">1</span>)</span><br><span class="line">             .Text = Str1</span><br><span class="line">             .Replacement.Text = Str2 <span class="comment">'替换字符串</span></span><br><span class="line">             .<span class="keyword">Execute</span> <span class="built_in">Replace</span>:=wdReplaceAll <span class="comment">'全部替换</span></span><br><span class="line">            <span class="keyword">Next</span> j</span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">        .ActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageHeader <span class="comment">'设置位置在页眉</span></span><br><span class="line">        Str1 = <span class="string">"数据001"</span></span><br><span class="line">        Str2 = Sheets(<span class="string">"数据2"</span>).Cells(i, <span class="number">2</span>)</span><br><span class="line">        .Selection.HomeKey Unit:=wdStory <span class="comment">'光标置于文件首</span></span><br><span class="line">        <span class="keyword">If</span> .Selection.Find.<span class="keyword">Execute</span>(Str1) <span class="keyword">Then</span> <span class="comment">'查找到指定字符串</span></span><br><span class="line">           .Selection.Font.Color = wdColorAutomatic <span class="comment">'字符为自动颜色</span></span><br><span class="line">           .Selection.Text = Str2 <span class="comment">'替换字符串</span></span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">      <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">      Word对象.Documents.Save</span><br><span class="line">      Word对象.Quit</span><br><span class="line">      <span class="keyword">Set</span> Word对象 = <span class="literal">Nothing</span></span><br><span class="line">   <span class="keyword">Next</span> i</span><br><span class="line">       </span><br><span class="line">   <span class="keyword">For</span> i = <span class="number">3</span> <span class="keyword">To</span> 最后行号</span><br><span class="line">      导出文件名 = <span class="string">"资产交割确认书：5份，总行公章+法人章"</span></span><br><span class="line">      FileCopy 当前路径 &amp; <span class="string">"\资产交割确认书：5份，总行公章+法人章.doc"</span>, 当前路径 &amp; <span class="string">"\"</span> &amp; 导出文件名 &amp; <span class="string">"("</span> &amp; Sheets(<span class="string">"数据"</span>).Range(<span class="string">"B"</span> &amp; i) &amp; <span class="string">").doc"</span></span><br><span class="line">      导出路径文件名 = 当前路径 &amp; <span class="string">"\"</span> &amp; 导出文件名 &amp; <span class="string">"("</span> &amp; Sheets(<span class="string">"数据"</span>).Range(<span class="string">"B"</span> &amp; i) &amp; <span class="string">").doc"</span></span><br><span class="line">      <span class="keyword">With</span> Word对象</span><br><span class="line">        .Documents.Open 导出路径文件名</span><br><span class="line">        .Visible = <span class="literal">False</span></span><br><span class="line">        .Selection.HomeKey Unit:=wdStory <span class="comment">'光标置于文件首</span></span><br><span class="line">        <span class="keyword">With</span> .Selection.Find <span class="comment">'填写文字数据</span></span><br><span class="line">            <span class="keyword">For</span> j = <span class="number">1</span> <span class="keyword">To</span> <span class="number">25</span></span><br><span class="line">             Str1 = <span class="string">"数据"</span> &amp; Format(j, <span class="string">"000"</span>)</span><br><span class="line">             Str2 = Sheets(<span class="string">"数据"</span>).Cells(i, j + <span class="number">1</span>)</span><br><span class="line">             .Text = Str1</span><br><span class="line">             .Replacement.Text = Str2 <span class="comment">'替换字符串</span></span><br><span class="line">             .<span class="keyword">Execute</span> <span class="built_in">Replace</span>:=wdReplaceAll <span class="comment">'全部替换</span></span><br><span class="line">            <span class="keyword">Next</span> j</span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">        .ActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageHeader <span class="comment">'设置位置在页眉</span></span><br><span class="line">        Str1 = <span class="string">"数据001"</span></span><br><span class="line">        Str2 = Sheets(<span class="string">"数据2"</span>).Cells(i, <span class="number">2</span>)</span><br><span class="line">        .Selection.HomeKey Unit:=wdStory <span class="comment">'光标置于文件首</span></span><br><span class="line">        <span class="keyword">If</span> .Selection.Find.<span class="keyword">Execute</span>(Str1) <span class="keyword">Then</span> <span class="comment">'查找到指定字符串</span></span><br><span class="line">           .Selection.Font.Color = wdColorAutomatic <span class="comment">'字符为自动颜色</span></span><br><span class="line">           .Selection.Text = Str2 <span class="comment">'替换字符串</span></span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">      <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">      Word对象.Documents.Save</span><br><span class="line">      Word对象.Quit</span><br><span class="line">      <span class="keyword">Set</span> Word对象 = <span class="literal">Nothing</span></span><br><span class="line">   <span class="keyword">Next</span> i</span><br><span class="line">       </span><br><span class="line">   <span class="keyword">For</span> i = <span class="number">3</span> <span class="keyword">To</span> 最后行号</span><br><span class="line">      导出文件名 = <span class="string">"交割确认函：5份，总行公章+法人章"</span></span><br><span class="line">      FileCopy 当前路径 &amp; <span class="string">"\交割确认函：5份，总行公章+法人章.doc"</span>, 当前路径 &amp; <span class="string">"\"</span> &amp; 导出文件名 &amp; <span class="string">"("</span> &amp; Sheets(<span class="string">"数据"</span>).Range(<span class="string">"B"</span> &amp; i) &amp; <span class="string">").doc"</span></span><br><span class="line">      导出路径文件名 = 当前路径 &amp; <span class="string">"\"</span> &amp; 导出文件名 &amp; <span class="string">"("</span> &amp; Sheets(<span class="string">"数据"</span>).Range(<span class="string">"B"</span> &amp; i) &amp; <span class="string">").doc"</span></span><br><span class="line">      <span class="keyword">With</span> Word对象</span><br><span class="line">        .Documents.Open 导出路径文件名</span><br><span class="line">        .Visible = <span class="literal">False</span></span><br><span class="line">        .Selection.HomeKey Unit:=wdStory <span class="comment">'光标置于文件首</span></span><br><span class="line">        <span class="keyword">With</span> .Selection.Find <span class="comment">'填写文字数据</span></span><br><span class="line">            <span class="keyword">For</span> j = <span class="number">1</span> <span class="keyword">To</span> <span class="number">25</span></span><br><span class="line">             Str1 = <span class="string">"数据"</span> &amp; Format(j, <span class="string">"000"</span>)</span><br><span class="line">             Str2 = Sheets(<span class="string">"数据"</span>).Cells(i, j + <span class="number">1</span>)</span><br><span class="line">             .Text = Str1</span><br><span class="line">             .Replacement.Text = Str2 <span class="comment">'替换字符串</span></span><br><span class="line">             .<span class="keyword">Execute</span> <span class="built_in">Replace</span>:=wdReplaceAll <span class="comment">'全部替换</span></span><br><span class="line">            <span class="keyword">Next</span> j</span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">        .ActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageHeader <span class="comment">'设置位置在页眉</span></span><br><span class="line">        Str1 = <span class="string">"数据001"</span></span><br><span class="line">        Str2 = Sheets(<span class="string">"数据2"</span>).Cells(i, <span class="number">2</span>)</span><br><span class="line">        .Selection.HomeKey Unit:=wdStory <span class="comment">'光标置于文件首</span></span><br><span class="line">        <span class="keyword">If</span> .Selection.Find.<span class="keyword">Execute</span>(Str1) <span class="keyword">Then</span> <span class="comment">'查找到指定字符串</span></span><br><span class="line">           .Selection.Font.Color = wdColorAutomatic <span class="comment">'字符为自动颜色</span></span><br><span class="line">           .Selection.Text = Str2 <span class="comment">'替换字符串</span></span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">      <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">      Word对象.Documents.Save</span><br><span class="line">      Word对象.Quit</span><br><span class="line">      <span class="keyword">Set</span> Word对象 = <span class="literal">Nothing</span></span><br><span class="line">   <span class="keyword">Next</span> i</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">   <span class="keyword">For</span> i = <span class="number">3</span> <span class="keyword">To</span> 最后行号</span><br><span class="line">      导出文件名 = <span class="string">"信托收益权转让登记表：3份，总行公章"</span></span><br><span class="line">      FileCopy 当前路径 &amp; <span class="string">"\信托收益权转让登记表：3份，总行公章.doc"</span>, 当前路径 &amp; <span class="string">"\"</span> &amp; 导出文件名 &amp; <span class="string">"("</span> &amp; Sheets(<span class="string">"数据"</span>).Range(<span class="string">"B"</span> &amp; i) &amp; <span class="string">").doc"</span></span><br><span class="line">      导出路径文件名 = 当前路径 &amp; <span class="string">"\"</span> &amp; 导出文件名 &amp; <span class="string">"("</span> &amp; Sheets(<span class="string">"数据"</span>).Range(<span class="string">"B"</span> &amp; i) &amp; <span class="string">").doc"</span></span><br><span class="line">      <span class="keyword">With</span> Word对象</span><br><span class="line">        .Documents.Open 导出路径文件名</span><br><span class="line">        .Visible = <span class="literal">False</span></span><br><span class="line">        .Selection.HomeKey Unit:=wdStory <span class="comment">'光标置于文件首</span></span><br><span class="line">        <span class="keyword">With</span> .Selection.Find <span class="comment">'填写文字数据</span></span><br><span class="line">            <span class="keyword">For</span> j = <span class="number">1</span> <span class="keyword">To</span> <span class="number">25</span></span><br><span class="line">             Str1 = <span class="string">"数据"</span> &amp; Format(j, <span class="string">"000"</span>)</span><br><span class="line">             Str2 = Sheets(<span class="string">"数据"</span>).Cells(i, j + <span class="number">1</span>)</span><br><span class="line">             .Text = Str1</span><br><span class="line">             .Replacement.Text = Str2 <span class="comment">'替换字符串</span></span><br><span class="line">             .<span class="keyword">Execute</span> <span class="built_in">Replace</span>:=wdReplaceAll <span class="comment">'全部替换</span></span><br><span class="line">            <span class="keyword">Next</span> j</span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">        .ActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageHeader <span class="comment">'设置位置在页眉</span></span><br><span class="line">        Str1 = <span class="string">"数据001"</span></span><br><span class="line">        Str2 = Sheets(<span class="string">"数据2"</span>).Cells(i, <span class="number">2</span>)</span><br><span class="line">        .Selection.HomeKey Unit:=wdStory <span class="comment">'光标置于文件首</span></span><br><span class="line">        <span class="keyword">If</span> .Selection.Find.<span class="keyword">Execute</span>(Str1) <span class="keyword">Then</span> <span class="comment">'查找到指定字符串</span></span><br><span class="line">           .Selection.Font.Color = wdColorAutomatic <span class="comment">'字符为自动颜色</span></span><br><span class="line">           .Selection.Text = Str2 <span class="comment">'替换字符串</span></span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">      <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">      Word对象.Documents.Save</span><br><span class="line">      Word对象.Quit</span><br><span class="line">      <span class="keyword">Set</span> Word对象 = <span class="literal">Nothing</span></span><br><span class="line">   <span class="keyword">Next</span> i</span><br><span class="line">  </span><br><span class="line">   <span class="keyword">For</span> i = <span class="number">3</span> <span class="keyword">To</span> 最后行号</span><br><span class="line">      导出文件名 = <span class="string">"信托资金保管合同"</span></span><br><span class="line">      FileCopy 当前路径 &amp; <span class="string">"\信托资金保管合同.doc"</span>, 当前路径 &amp; <span class="string">"\"</span> &amp; 导出文件名 &amp; <span class="string">"("</span> &amp; Sheets(<span class="string">"数据"</span>).Range(<span class="string">"B"</span> &amp; i) &amp; <span class="string">").doc"</span></span><br><span class="line">      导出路径文件名 = 当前路径 &amp; <span class="string">"\"</span> &amp; 导出文件名 &amp; <span class="string">"("</span> &amp; Sheets(<span class="string">"数据"</span>).Range(<span class="string">"B"</span> &amp; i) &amp; <span class="string">").doc"</span></span><br><span class="line">      <span class="keyword">With</span> Word对象</span><br><span class="line">        .Documents.Open 导出路径文件名</span><br><span class="line">        .Visible = <span class="literal">False</span></span><br><span class="line">        .Selection.HomeKey Unit:=wdStory <span class="comment">'光标置于文件首</span></span><br><span class="line">        <span class="keyword">With</span> .Selection.Find <span class="comment">'填写文字数据</span></span><br><span class="line">            <span class="keyword">For</span> j = <span class="number">1</span> <span class="keyword">To</span> <span class="number">25</span></span><br><span class="line">             Str1 = <span class="string">"数据"</span> &amp; Format(j, <span class="string">"000"</span>)</span><br><span class="line">             Str2 = Sheets(<span class="string">"数据"</span>).Cells(i, j + <span class="number">1</span>)</span><br><span class="line">             .Text = Str1</span><br><span class="line">             .Replacement.Text = Str2 <span class="comment">'替换字符串</span></span><br><span class="line">             .<span class="keyword">Execute</span> <span class="built_in">Replace</span>:=wdReplaceAll <span class="comment">'全部替换</span></span><br><span class="line">            <span class="keyword">Next</span> j</span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">        .ActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageHeader <span class="comment">'设置位置在页眉</span></span><br><span class="line">        Str1 = <span class="string">"数据001"</span></span><br><span class="line">        Str2 = Sheets(<span class="string">"数据2"</span>).Cells(i, <span class="number">2</span>)</span><br><span class="line">        .Selection.HomeKey Unit:=wdStory <span class="comment">'光标置于文件首</span></span><br><span class="line">        <span class="keyword">If</span> .Selection.Find.<span class="keyword">Execute</span>(Str1) <span class="keyword">Then</span> <span class="comment">'查找到指定字符串</span></span><br><span class="line">           .Selection.Font.Color = wdColorAutomatic <span class="comment">'字符为自动颜色</span></span><br><span class="line">           .Selection.Text = Str2 <span class="comment">'替换字符串</span></span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">      <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">      Word对象.Documents.Save</span><br><span class="line">      Word对象.Quit</span><br><span class="line">      <span class="keyword">Set</span> Word对象 = <span class="literal">Nothing</span></span><br><span class="line">   <span class="keyword">Next</span> i</span><br><span class="line">   <span class="keyword">For</span> i = <span class="number">3</span> <span class="keyword">To</span> 最后行号</span><br><span class="line">      导出文件名 = <span class="string">"财产权受益权转让合同：5份，总行公章、法人章_骑缝"</span></span><br><span class="line">      FileCopy 当前路径 &amp; <span class="string">"\财产权受益权转让合同：5份，总行公章、法人章_骑缝.doc"</span>, 当前路径 &amp; <span class="string">"\"</span> &amp; 导出文件名 &amp; <span class="string">"("</span> &amp; Sheets(<span class="string">"数据"</span>).Range(<span class="string">"B"</span> &amp; i) &amp; <span class="string">").doc"</span></span><br><span class="line">      导出路径文件名 = 当前路径 &amp; <span class="string">"\"</span> &amp; 导出文件名 &amp; <span class="string">"("</span> &amp; Sheets(<span class="string">"数据"</span>).Range(<span class="string">"B"</span> &amp; i) &amp; <span class="string">").doc"</span></span><br><span class="line">      <span class="keyword">With</span> Word对象</span><br><span class="line">        .Documents.Open 导出路径文件名</span><br><span class="line">        .Visible = <span class="literal">False</span></span><br><span class="line">        .Selection.HomeKey Unit:=wdStory <span class="comment">'光标置于文件首</span></span><br><span class="line">        <span class="keyword">With</span> .Selection.Find <span class="comment">'填写文字数据</span></span><br><span class="line">            <span class="keyword">For</span> j = <span class="number">1</span> <span class="keyword">To</span> <span class="number">25</span></span><br><span class="line">             Str1 = <span class="string">"数据"</span> &amp; Format(j, <span class="string">"000"</span>)</span><br><span class="line">             Str2 = Sheets(<span class="string">"数据"</span>).Cells(i, j + <span class="number">1</span>)</span><br><span class="line">             .Text = Str1</span><br><span class="line">             .Replacement.Text = Str2 <span class="comment">'替换字符串</span></span><br><span class="line">             .<span class="keyword">Execute</span> <span class="built_in">Replace</span>:=wdReplaceAll <span class="comment">'全部替换</span></span><br><span class="line">            <span class="keyword">Next</span> j</span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">        .ActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageHeader <span class="comment">'设置位置在页眉</span></span><br><span class="line">        Str1 = <span class="string">"数据001"</span></span><br><span class="line">        Str2 = Sheets(<span class="string">"数据2"</span>).Cells(i, <span class="number">2</span>)</span><br><span class="line">        .Selection.HomeKey Unit:=wdStory <span class="comment">'光标置于文件首</span></span><br><span class="line">        <span class="keyword">If</span> .Selection.Find.<span class="keyword">Execute</span>(Str1) <span class="keyword">Then</span> <span class="comment">'查找到指定字符串</span></span><br><span class="line">           .Selection.Font.Color = wdColorAutomatic <span class="comment">'字符为自动颜色</span></span><br><span class="line">           .Selection.Text = Str2 <span class="comment">'替换字符串</span></span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">      <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">      Word对象.Documents.Save</span><br><span class="line">      Word对象.Quit</span><br><span class="line">      <span class="keyword">Set</span> Word对象 = <span class="literal">Nothing</span></span><br><span class="line">   <span class="keyword">Next</span> i</span><br><span class="line">   </span><br><span class="line">   <span class="keyword">If</span> 判断 = <span class="number">0</span> <span class="keyword">Then</span></span><br><span class="line">      i = <span class="built_in">MsgBox</span>(<span class="string">"已输出到 Word 文件！"</span>, <span class="number">0</span> + <span class="number">48</span> + <span class="number">256</span> + <span class="number">0</span>, <span class="string">"提示："</span>)</span><br><span class="line">   <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> CommandButton输出通知到Word文件_Click()</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>恰好这次有个客户反馈word模板目录有问题，于是经过几天李笑来老师的自学之书的指点，加上对python的进一步理解，对编程算是有了一点点进步，结合前面几位牛人的代码，我算是完成了代码的升级，所以命名2.0，代码如下：</li>
</ol>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> CommandButton1_Click()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">Dim</span> Str1, Str2</span><br><span class="line">    <span class="keyword">Dim</span> j</span><br><span class="line">    <span class="keyword">Dim</span> wdApp As Word.Application</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">Set</span> myFolder = <span class="built_in">CreateObject</span>(<span class="string">"Shell.Application"</span>).BrowseForFolder(<span class="number">0</span>, <span class="string">"GetFolder"</span>, <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">If</span> <span class="keyword">Not</span> myFolder <span class="keyword">Is</span> <span class="literal">Nothing</span> <span class="keyword">Then</span> myPath$ = myFolder.Items.Item.Path <span class="keyword">Else</span> <span class="built_in">MsgBox</span> <span class="string">"Folder not Selected"</span>: <span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line">    <span class="keyword">If</span> <span class="built_in">Right</span>(myPath, <span class="number">1</span>) &lt;&gt; <span class="string">""</span> <span class="keyword">Then</span> myPath = myPath &amp; <span class="string">""</span></span><br><span class="line">    <span class="comment">'同样返回的是选中目标文件夹的绝对路径,但除了本地C盘、D盘会以"C:"形式返回外，其余路径无""需要添加</span></span><br><span class="line">    判断 = <span class="number">0</span></span><br><span class="line">    Application.ScreenUpdating = <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">Set</span> fld = <span class="built_in">CreateObject</span>(<span class="string">"Scripting.FileSystemObject"</span>).GetFolder(myPath) <span class="comment">'设置FSO实例</span></span><br><span class="line">       </span><br><span class="line">    <span class="keyword">For</span> <span class="keyword">Each</span> f <span class="keyword">In</span> fld.files <span class="comment">'遍历文件夹</span></span><br><span class="line">     <span class="comment">'以下代码实现每个文件的查找替换</span></span><br><span class="line">        <span class="keyword">Set</span> wdApp = <span class="keyword">New</span> Word.Application</span><br><span class="line">        <span class="keyword">If</span> <span class="built_in">Right</span>(f.Name, <span class="number">4</span>) = <span class="string">".doc"</span> <span class="keyword">And</span> <span class="built_in">InStr</span>(f.Name, <span class="string">"$"</span>) = <span class="number">0</span> <span class="keyword">Then</span></span><br><span class="line">        <span class="keyword">With</span> wdApp</span><br><span class="line">            .Documents.Open (f) <span class="comment">'打开文件，进行操作</span></span><br><span class="line">            .Visible = <span class="literal">False</span></span><br><span class="line">            .Selection.HomeKey Unit:=wdStory <span class="comment">'光标置于文件首</span></span><br><span class="line">            <span class="keyword">With</span> .Selection.Find <span class="comment">'填写文字数据</span></span><br><span class="line">                <span class="keyword">For</span> j = <span class="number">1</span> <span class="keyword">To</span> <span class="number">49</span></span><br><span class="line">                    Str1 = <span class="string">"数据"</span> &amp; Format(j, <span class="string">"000"</span>)</span><br><span class="line">                    Str2 = Sheets(<span class="string">"数据"</span>).Cells(<span class="number">3</span>, j + <span class="number">1</span>)</span><br><span class="line">                    .Text = Str1</span><br><span class="line">                    .Replacement.Text = Str2 <span class="comment">'替换字符串</span></span><br><span class="line">                    .<span class="keyword">Execute</span> <span class="built_in">Replace</span>:=wdReplaceAll <span class="comment">'全部替换</span></span><br><span class="line">                <span class="keyword">Next</span> j</span><br><span class="line">            <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">        </span><br><span class="line">            .ActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageHeader <span class="comment">'设置位置在页眉</span></span><br><span class="line">                Str1 = <span class="string">"数据001"</span></span><br><span class="line">                Str2 = Sheets(<span class="string">"数据2"</span>).Cells(<span class="number">3</span>, <span class="number">2</span>)</span><br><span class="line">                .Selection.HomeKey Unit:=wdStory <span class="comment">'光标置于文件首</span></span><br><span class="line">      </span><br><span class="line">                 <span class="keyword">If</span> .Selection.Find.<span class="keyword">Execute</span>(Str1) <span class="keyword">Then</span> <span class="comment">'查找到指定字符串</span></span><br><span class="line">                    .Selection.Text = Str2 <span class="comment">'替换字符串</span></span><br><span class="line">                 <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">             </span><br><span class="line">            .Documents.Save</span><br><span class="line">            .Quit</span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">        <span class="keyword">Set</span> wdApp = <span class="literal">Nothing</span></span><br><span class="line">    <span class="keyword">Next</span></span><br><span class="line">    Application.ScreenUpdating = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">If</span> 判断 = <span class="number">0</span> <span class="keyword">Then</span></span><br><span class="line">        i = <span class="built_in">MsgBox</span>(<span class="string">"已输出到 Word 文件！"</span>, <span class="number">0</span> + <span class="number">49</span> + <span class="number">256</span> + <span class="number">0</span>, <span class="string">"提示："</span>)</span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> CommandButton输出通知到Word文件_Click()</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li><strong>继续优化</strong> 代码，实现通用的批量查找替换</li>
</ol>
<p>其实很容易，就把上面代码第26行修改为如下即可：</p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Str1 = Sheets(<span class="string">"数据"</span>).Cells(<span class="number">2</span>, j + <span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<p>修改后的使用方法：</p>
<blockquote>
<ol>
<li>选择需要批量替换的文件夹</li>
<li>注意指定文档为.doc的文档，这个可以通过修改代码来改为所有文件</li>
<li>在excel输入项里，第二行填写旧信息，第三行填写需要替换的信息</li>
<li>点击按钮即可，设置最多的是49项，可以通过修改代码增加或减少</li>
</ol>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://hnzyc.github.io,http//y2s6pn.coding-pages.com/2020/04/10/FSO%E4%B9%8B%E6%96%87%E4%BB%B6%E5%8F%8A%E6%96%87%E4%BB%B6%E5%A4%B9%E6%93%8D%E4%BD%9C%E5%8F%8A%E8%8E%B7%E5%8F%96%E7%9B%B8%E5%85%B3%E5%B1%9E%E6%80%A7%E7%AD%89/" data-id="ck8ub49kb001cwctsgs9zdnk8" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2020/04/10/2017-05-03-%E5%BC%80%E7%AF%87/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">2017-05-03-开篇</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/BBC/" rel="tag">BBC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/" rel="tag">Git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hosts/" rel="tag">Hosts</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mac/" rel="tag">Mac</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Markdown/" rel="tag">Markdown</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/" rel="tag">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B9%A6%E5%8D%95/" rel="tag">书单</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%88%86%E4%BA%AB/" rel="tag">分享</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%9F%9F%E5%90%8D/" rel="tag">域名</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8A%80%E6%9C%AF/" rel="tag">技术</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8A%95%E8%B5%84/" rel="tag">投资</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8A%98%E8%85%BE/" rel="tag">折腾</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%99%E8%82%B2/" rel="tag">教育</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%BC%94%E8%AE%B2/" rel="tag">演讲</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%90%86%E8%B4%A2/" rel="tag">理财</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%A6%8F%E5%88%A9/" rel="tag">福利</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BA%AA%E5%BD%95%E7%89%87/" rel="tag">纪录片</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BB%88%E8%BA%AB%E5%AD%A6%E4%B9%A0/" rel="tag">终身学习</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" rel="tag">网络安全</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%82%B2%E5%84%BF/" rel="tag">育儿</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%8B%B1%E8%AF%AD/" rel="tag">英语</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%B4%A2%E5%8A%A1%E8%87%AA%E7%94%B1/" rel="tag">财务自由</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%B4%A2%E5%AF%8C/" rel="tag">财富</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%B5%84%E6%BA%90/" rel="tag">资源</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/BBC/" style="font-size: 10px;">BBC</a> <a href="/tags/Git/" style="font-size: 10px;">Git</a> <a href="/tags/Hosts/" style="font-size: 13.33px;">Hosts</a> <a href="/tags/Mac/" style="font-size: 13.33px;">Mac</a> <a href="/tags/Markdown/" style="font-size: 10px;">Markdown</a> <a href="/tags/python/" style="font-size: 10px;">python</a> <a href="/tags/%E4%B9%A6%E5%8D%95/" style="font-size: 10px;">书单</a> <a href="/tags/%E5%88%86%E4%BA%AB/" style="font-size: 16.67px;">分享</a> <a href="/tags/%E5%9F%9F%E5%90%8D/" style="font-size: 10px;">域名</a> <a href="/tags/%E6%8A%80%E6%9C%AF/" style="font-size: 10px;">技术</a> <a href="/tags/%E6%8A%95%E8%B5%84/" style="font-size: 10px;">投资</a> <a href="/tags/%E6%8A%98%E8%85%BE/" style="font-size: 20px;">折腾</a> <a href="/tags/%E6%95%99%E8%82%B2/" style="font-size: 13.33px;">教育</a> <a href="/tags/%E6%BC%94%E8%AE%B2/" style="font-size: 10px;">演讲</a> <a href="/tags/%E7%90%86%E8%B4%A2/" style="font-size: 16.67px;">理财</a> <a href="/tags/%E7%A6%8F%E5%88%A9/" style="font-size: 16.67px;">福利</a> <a href="/tags/%E7%BA%AA%E5%BD%95%E7%89%87/" style="font-size: 10px;">纪录片</a> <a href="/tags/%E7%BB%88%E8%BA%AB%E5%AD%A6%E4%B9%A0/" style="font-size: 10px;">终身学习</a> <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" style="font-size: 10px;">网络安全</a> <a href="/tags/%E8%82%B2%E5%84%BF/" style="font-size: 10px;">育儿</a> <a href="/tags/%E8%8B%B1%E8%AF%AD/" style="font-size: 10px;">英语</a> <a href="/tags/%E8%B4%A2%E5%8A%A1%E8%87%AA%E7%94%B1/" style="font-size: 13.33px;">财务自由</a> <a href="/tags/%E8%B4%A2%E5%AF%8C/" style="font-size: 10px;">财富</a> <a href="/tags/%E8%B5%84%E6%BA%90/" style="font-size: 10px;">资源</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/04/10/FSO%E4%B9%8B%E6%96%87%E4%BB%B6%E5%8F%8A%E6%96%87%E4%BB%B6%E5%A4%B9%E6%93%8D%E4%BD%9C%E5%8F%8A%E8%8E%B7%E5%8F%96%E7%9B%B8%E5%85%B3%E5%B1%9E%E6%80%A7%E7%AD%89/">FSO之文件及文件夹操作及获取相关属性等</a>
          </li>
        
          <li>
            <a href="/2020/04/10/2017-05-03-%E5%BC%80%E7%AF%87/">2017-05-03-开篇</a>
          </li>
        
          <li>
            <a href="/2020/04/09/poems-of-Kyle/">赵翀的诗</a>
          </li>
        
          <li>
            <a href="/2020/04/09/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2019/03/29/2019-03-29-%E5%8D%81%E5%B9%B4%E8%B4%A2%E5%8A%A1%E8%87%AA%E7%94%B1%E4%B9%8B%E8%B7%AF%E2%80%94%E2%80%94%E6%8A%95%E8%B5%84%E5%AE%9E%E8%AF%81#1/">十年财务自由之路——投资实证#1</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 Davy Zhao<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>